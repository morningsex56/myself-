(function(_0x469036,_0x4504ec){function _0x213b3c(_0x10ab6d,_0x33af2f,_0x40823e,_0x1d1ad0){return _0x5357(_0x33af2f-0x161,_0x10ab6d);}const _0x472f05=_0x469036();function _0x477f0e(_0x421f30,_0x36b511,_0x58873b,_0x143417){return _0x5357(_0x421f30-0x1dc,_0x36b511);}while(!![]){try{const _0x19ad74=-parseInt(_0x213b3c(0x27b,0x2fd,0x2c5,0x2ed))/(0x2*0x989+0x24*-0x62+-0x3*0x1c3)+parseInt(_0x477f0e(0x478,0x3a5,0x45e,0x435))/(-0x1229+-0x25e+0x1489)*(parseInt(_0x477f0e(0x347,0x297,0x415,0x34c))/(0x2345*-0x1+0x1860+0xae8))+parseInt(_0x477f0e(0x3a2,0x40d,0x44e,0x37b))/(0x1dc3*0x1+-0xa9+0x92*-0x33)+parseInt(_0x477f0e(0x3f7,0x431,0x492,0x464))/(-0x1*-0x19df+0x1*-0x214e+0xc*0x9f)+-parseInt(_0x477f0e(0x466,0x51f,0x4b3,0x4de))/(-0x1f60+-0x135+0x209b)*(parseInt(_0x477f0e(0x320,0x2ef,0x264,0x297))/(0x35*0x7f+-0x185a*0x1+-0x1ea))+parseInt(_0x477f0e(0x4d0,0x477,0x4db,0x4de))/(0x253c+-0x89+-0x24ab)*(-parseInt(_0x477f0e(0x4cb,0x4cf,0x564,0x4a4))/(0x20*-0x2c+0x1d06+-0x177d))+parseInt(_0x213b3c(0x34c,0x376,0x360,0x345))/(0x56a*0x2+-0x231+-0x899)*(parseInt(_0x477f0e(0x3d0,0x373,0x455,0x47a))/(0x55b+-0xb6f*0x1+0x61f));if(_0x19ad74===_0x4504ec)break;else _0x472f05['push'](_0x472f05['shift']());}catch(_0x5314b5){_0x472f05['push'](_0x472f05['shift']());}}}(_0x5513,-0x68*0x176b+-0x98e1*0x7+0x141737));const _0x5ea112=(function(){let _0x521b61=!![];return function(_0x2e82fe,_0x4bb61b){const _0x353f6e=_0x521b61?function(){function _0x42aacf(_0x56cf3a,_0x2c76f6,_0x544f50,_0xd42fea){return _0x5357(_0x2c76f6-0x158,_0x544f50);}if(_0x4bb61b){const _0x4514dd=_0x4bb61b[_0x42aacf(0x246,0x2c0,0x2b3,0x399)](_0x2e82fe,arguments);return _0x4bb61b=null,_0x4514dd;}}:function(){};return _0x521b61=![],_0x353f6e;};}()),_0x3e79e5=_0x5ea112(this,function(){const _0x5df53c={};_0x5df53c['DFdem']=_0x5aa4a4(0x12a,-0x6,0x5f,0x96)+'+$';const _0x29aaad=_0x5df53c;function _0x79bcce(_0x342868,_0x8e3e74,_0x1657bf,_0x4a61b1){return _0x5357(_0x4a61b1- -0x273,_0x8e3e74);}function _0x5aa4a4(_0x420466,_0x3bc219,_0x5a57b2,_0x4b866c){return _0x5357(_0x4b866c- -0x16c,_0x3bc219);}return _0x3e79e5[_0x5aa4a4(0xb1,0x15c,0x12e,0x172)]()['search'](_0x29aaad['DFdem'])[_0x79bcce(0x135,0x7d,-0x57,0x6b)]()[_0x79bcce(-0x84,0x8f,-0xf,-0x14)+'r'](_0x3e79e5)[_0x5aa4a4(-0x73,-0x96,-0x87,-0x11)](_0x5aa4a4(-0xd,0x10a,0x77,0x96)+'+$');});function _0x5513(){const _0x2c2899=['CMvTB3zLtgLZDa','zw1PDa','uhf0she','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','5zco572U5zco','zwrKzwqGyMfZzq','vhPOqMi','sg92v0K','DhLWzq','C3rYAw5NAwz5','w0jHBMfUyv0GrG','DMnpzMO','rvvQwuS','w0jHBMfUyv0GuG','y29TCgXLDgvuyq','Aw5PDgLHBgL6zq','BNnLigzVCIbjra','DwnJzxnZzNvSBa','mZiXnJrpr21UvgW','yMfUyw5HioEuN+wBVUs6IW','5lIT55QeihbYB21WDooaGG','yNLiwLi','r1nmDKW','zML4zwrqCM9TCa','DwzMyvC','5zU+5lQl5lU255Ur5zcS5zMO5BEY5ywZ6zET44cc','vfHNEKe','sfrtB08','zw5bssbMB3jTyq','C3bSAxq','yNnwqM8','BwfNzsbPBIbpCa','kcGOlISPkYKRkq','qvDjuwK','5lU75yQH5BEY5y+w5RAi','lI4U','zMv0y2GGAw1HzW','AhzNDw8','ueL6vfy','EhfuC0W','AevPD1a','B3vUzcbTyxrJAa','w0jHBMfUyv0GuW','y29UDMvYC2f0Aq','BwvZC2fNzq','zw5KC1DPDgG','qxv0Ag9YAxPHDa','C3vIC3rYAw5N','AvvWtMO','Cgj3yMC','w0jHBMfUyv0G5Ps2','mtC0me5ns1vUuW','CLLiB0y','Bwf0y2G','D2L0AcbWCM9TCa','veTMAeu','tLLIwM4','mJq4nJq0nxvPEvHhDq','zLbLyvm','yxLSB2fKoIa','z2TQt3q','BIbWyxLSB2fKia','5Q2J6z2I5O+q56s66k+noIa','mc4WlJaUmcbtyq','y29UDgvUDa','v1PXBvC','5BYa5AEliejHBMfUyEEuNW','CuDVu08','zMfYAs81mZCUmW','Egjmy3C','zxrJAcbnyxjRza','suPIDMm','AxrOihn0yxr1CW','zLrYtw8','A3vJCNK','igLTywDLihrVia','wNH2A3u','BwrcBxG','uMPYuwq','C2fTCgXLq291BG','ihWG','vvjm','5zU+5QIH5BYp77YA5BEY5RE75yQG5B6f5l+U5Ps5','weneEKq','AMfhy2W','Aw9UoIaIqMvHCG','BwfW','ieLeia','tfbWBvi','uLfJswq','Aw1Hz2veyxrH','zw5KAw5NihjLCq','EvHvAuO','Dg9mB3DLCKnHCW','BxntBgm','Axbczxu','Aw1Hz2vU','AuL4BwK','Bw9KzwW6ia','DwLSDcbjBwfNzq','Bxb0','ywDLigDLBMvYyq','ru5qzKK','re1dCgS','v3bqAfO','kerPDMLKzv9YBW','twnWtge','uMH4Eeq','wvbdC08','vhnRthO','ksbbChbSzvDLyG','ztOG','DxbKyxrLu3rHDa','zK9Vr2S','y2LZAhu','q0fuBuK','yxjRzg93BIbPBq','ue9tva','BgvZktOG','BwfNzsbNzw5LCG','y2rIqw0','C2v0ici','ufrqDwi','uLvPy3a','ueDSBwi','y29UC3rYDwn0BW','55sO55U05O6L6k+35Rgc5QIH5BYp','BK9Zsfy','Duj4AhG','C2LUzYbKAxjLyW','veHTz3e','5zU+5Rwb56Il44cc5A6I5OI356UV5lI6','w0jHBMfUyv0Gtq','rw5nsfe','C3rFy2HHDhu4xW','zMLSDgvY','BNrHAw5ZihrLEa','w0jHBMfUyv0Gra','D2jTB0G','ywXSyMfJAY4','uhrms2K','uvr2q2S','l2DLBMvYyxrL','w0jHBMfUyv0G55sF','AhLvqxK','zM9YrwfJAa','yw5Hx3rHC2S','zcbnyxjRzg93BG','vxnLCI1bz2vUDa','B1DdyM8','CgfYyw1LDgvYCW','CMvWBgfJzq','E+s/RUwBVN0','qKfoqu5b','r1HxB1O','uxnuqva','uNDrEwq','mNWZFdr8mhWX','5yMn572U5zco','zMfPBgvKigzVCG','zMXHDa','AvnVtfu','A3nrtgC','5B2t5yMn55sF5zU+5QYH5PwW5lI6igzV','v05mt00','EKrMB3u','Bw9KzwW','yxrLzcbZDwnJzq','nMjdEvvADa','v0fdweK','tKHpAxu','AhnpzeG','z2uGvvjmlcbLEa','w0jHBMfUyv0Grq','whPRwKy','55sO5lQo55sF5OIq55QevgfNoIa','tLnf','yxnRsuq6ia','qvbjihjLC3bVBG','zhbLzMm','D3b0Aey','5RAi5B2t5yMn5lU75yQH77Ym5y+r6ycb5AsX6lsL','yMfUyw5Hq2HHCG','DhjPBq','vKTtqNG','r0vorvjbvevFsq','mtrzzxzfEKu','qwnJzxb0','vKrdrgO','5zon5BQuicHjrdOG','DxPouM4','BhvKzv9OzwfKzq','z0rtzva','zxrJAcbLCNjVCG','z3bVrM4','zxrPB25FC291CG','wNfjshi','Aw5NihrYAwDNzq','B21WBgv0Aw9UCW','vNjIyLu','BI9QC29U','DNLisuu','DgfYDgLUzYbPBq','DNPQDgG','ywLSzwqGDg8GzG','5lU255Ur5zcS5zMO5BEY5yID5AEl5yYw44cc','B3nPDgLVBG','Aw9U','CMvZDwX0','EwT3BxK','yxbWBgLJyxrPBW','w0jHBMfUyv0Gsq','y2fUy2vSx2jHBG','tufhrv9srvnqtW','Cu93t3i','B3DUigLTywDLoG','zKvrs1a','AgjWzeS','5l+U5zU+5zU+54MhoIbB5BEY5O+q5l6B','CM9Szq','rMvwANK','CMTKB3DUigLTyq','y2XPzw50','DcbvuKWGyxmGzG','wMHQuge','zxjYB3i','5zU+5yop5BEY5A2y5ywL5PwW5O2U5BQtigy','q01VqKW','DxjS','v0PjtuC','w0jHBMfUyv0GrW','CIaI','ywDLifvstdOG','w0jHBMfUyv0Gvq','vgjgC0e','A2LeuMC','Ag1btgm','rNfbqLu','y3vZDg9T','5zU+5QIH5BYp77YA5OYh5lUKid0G','l3yX','AevprfK','q0fSyNu','l2fWAs9IywnRzq','D2LpqLa','sLHoCK8','wePxsMi','rfHID20','D1P4Be4','DhjHy3rPBMCUlG','q2HHCMfJDgvYia','DMTLCgW','Dg9tDhjPBMC','ELzNCgq','BMXNuxi','zw5LCMf0Aw9Uia','ANnVBG','sNbkDKy','l3yXyMv0ys9TBW','vLPKAvm','AhvntKW','AKXxt2O','rMfPBgvKihrVia','zxiG','EgnXrMm','Aw5JBhvKzxm','EvvKq3G','v0fgC1C','BeXQtMS','ndq3mJfVy3LPAMi','zw5LCG','DhzoCvK','Cu5oCg0','Aw1Hz2vFDxjS','mtm2yMT1rNb1','Aw1Hz2vdB25MAq','sgvUyxa','BMnfyxu','yxnZAxn0yw50','CNLZvee','Bw9Kzq','ntyZntK1mLDbuuviEa','uxHcqwW','suPrELG','y29UDMvYDfrVsG','zvvxDeC','CNbIwe4','Bgn3sLG','thvNBNa','55sO5l+U5zU+6Ake6k6+oIaI','EfLSwem','sMvNDxm','AeDqtMq','su9kz0K','BwvZC2fNzxm','rwDQBLi','qMfUyw5HtgLZDa','l3yXlW','kI8Q','zeXQrey','DxnLCG','ie5uideWlJa7ia','C3rHCNrZv2L0Aa','mNW0Fdb8mxWZ','C2vHCMnO','CMvWBgfJzufSBa','B1nfrLy','BKzMzKm','zgvSCY8','AwTLieDLy2TVkq','AxnbCNjHEq','yxnWzwn0uMf0Aq','zxrLy3rLzcbnyq','CMTKB3DUigvTyG','Eezpr3m','tw96AwXSys81lG','qKz6t1K','yxbWBhK','zwnLAxzLzcbPBq','BhvYzsbYzxnWBW','mtuWmdi3shvHsNzi','Aw5ZDgfUy2vZ','yLHtshy','EsbLEhrYywn0zq','runbEee','nJqGAw1Hz2uU','uwLJwMi','zxryDLK','C3rYAw5N','zLzmChm','igLTywDLlG','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','ifbYB21WDa','DgLVBIb3AxrOia','s2L0lZuZnY4ZnG','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','5l+U5zU+5OYh5lUKoIa','yMfUyw5H','55sO5lQgihVKV67LM759ioAGH+IVHG','vfj3rgS','ienOCM9Tzs8XmG','z3byENO','B0fRy2S','ywrKvgfZAW','C3rYzwfT','AvvYBeO','BwL0DgvKihn1yW','EsbJB252zxj0zq','ywjgEu0','A29IsvC','5zco572U5yMn','q0Hhr1O','DwvZDcb0BZOG','w0jHBMfUyv0Gua','5PIV5zcM5zcV55sO5yIg6kEs6iMY5QIH5BYpia','Dgv4Da','svjMDvG','CMvHzefZrgf0yq','sMztDwK','weXHz3G','AgHWAuy','DcbMywLSzwqGDW','5PYa5zco572U','q29UDgvUDc1uEq','C2uGzgLKig5VDa','CNPpB2i','Ehzuq0i','Aw1Hz2u','sMros1m','odi3nJmZuxHiu1v6','m3WXFdj8nhWW','ruf4q1u','q3zjyKm','CIbWCM9TChq6ia','C3vJy2vZCW','B2fKihDPDgGG','5O6L6k+35Rgc','Cg9ZDgzPEfbYBW','qMfUyw5H5l+U5zU+5QIH5BYp','zM9hvuW','v2DHAgu','6k+35Rgc5Bc65A+4oIdLRR3LUQyGlq','DhjPz2DLCNm','AgDNrgG','C3rHDhvZ','Bw9KywWGCgf5Ba','lcdPQ5JLUQyGlsa','rxbKzue','sxH5twC','t29ttu4','5yIW5y+w5RAi5lU75yQH5lQl5lU2icHu','zgf0ytPPBwfNzq','BgvUz3rO','w0jHBMfUyv0GqG','v09zEgm','B1Perxm','Dg9Rzw4','sLPnrwG','55Qe5zU+54Mh','tufhrv9srvfvrq','EwvMCwe','yxzouhe','q3vgDhe','rw94Ewe','EgrYveO','mcaOv2LUzg93CW','ChjVBxb0','v2LUnJq7ihG2na','ruLNrKS','y2HHBMDL','yMfZzty0lG','mZeYmtm1mKXzy1vWza','ignVBNrHAw4GAq','w0jHBMfUyv0G5l+U','BwfNzw4G5QIH5z6l5lIn5PsV','q2TvBNK','rNzms1C','zgHfrxO','DgLVBIbYzxf1zq','5OYb6yws6AAg5lUJ55cg77Ym5yIh5O2I5lI655U0','AM9PBG','zhfcru0','w0jHBMfUyv0G5l2/','y2HVAwnLCW','vM94B2m','Aw1Hz2vjza','qNPrExe','De56Bhi','BMzjueW','y3vZDg9Tx3vYBa','ELjwvLO','ChvZAa','l3yXl2nOyxqVyW','w0jHBMfUyv0G5zcV','zcbIyxnLnJqGAq','BKn5ALG','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','rKr6q04','twfYA2rVD24U'];_0x5513=function(){return _0x2c2899;};return _0x5513();}_0x3e79e5();import{extension_settings}from'../../../../extensions.js';import{eventSource}from'../../../../../script.js';import{extensionName,EventType}from'./config.js';import{sleep,generateRandomSeed,zhengmian,fumian,getRequestHeaders,prompt_replace,addLog,clearLog,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations,convertImageToJpeg}from'./utils.js';import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';import{setItemImg}from'./database.js';import{getConfigImage}from'./configDatabase.js';import{taskQueue,TaskType,TaskStatus}from'./taskQueue.js';function getDirectHeaders(_0x5998f3=null,_0x56d707=null){const _0x4c406b={};_0x4c406b[_0x5c5aca(0x41f,0x4bc,0x41b,0x4e5)]=_0x2df53a(0xb6,0x50,-0x1a,-0x35)+_0x5c5aca(0x47a,0x4aa,0x3fb,0x40f)+_0x5c5aca(0x3f1,0x30c,0x396,0x3a7)+_0x5c5aca(0x4a2,0x378,0x459,0x411)+_0x2df53a(0x88,0x182,0xd0,0xa3)+'Kit/537.36'+'\x20(KHTML,\x20l'+_0x5c5aca(0x36e,0x345,0x2d5,0x3af)+_0x2df53a(0xd1,0x78,-0x1,-0x78)+'0.0.0.0\x20Sa'+_0x5c5aca(0x52d,0x478,0x455,0x475)+'6',_0x4c406b[_0x2df53a(0x26,0x17,-0x3e,-0x30)]=_0x5c5aca(0x338,0x335,0x409,0x3a4),_0x4c406b[_0x2df53a(-0x77,0x33,-0x33,0x7a)]=_0x5c5aca(0x3ac,0x3f5,0x38f,0x3e5)+'pe',_0x4c406b[_0x5c5aca(0x4af,0x498,0x46d,0x50a)]=function(_0x3e6984,_0x22d396){return _0x3e6984!==_0x22d396;},_0x4c406b['XLagx']='fFajs';function _0x2df53a(_0x3aa0f2,_0x5e404d,_0x411976,_0x263bab){return _0x5357(_0x411976- -0x180,_0x3aa0f2);}_0x4c406b['wiOBP']='obUAn',_0x4c406b[_0x2df53a(0x1a8,0x195,0xcf,0x30)]=_0x2df53a(-0x3,-0x3c,0x90,0xf6)+'ion';const _0xcf460d=_0x4c406b,_0xb39854={};_0xb39854[_0x2df53a(0x95,0x1c9,0xf6,0xe9)]=_0xcf460d[_0x5c5aca(0x48d,0x59e,0x57a,0x4e5)],_0xb39854[_0x5c5aca(0x526,0x53c,0x5c5,0x4ec)]=_0xcf460d[_0x5c5aca(0x423,0x2c0,0x3a5,0x391)];const _0x2a1c05=_0xb39854;_0x5998f3&&(_0x2a1c05[_0xcf460d[_0x5c5aca(0x37b,0x3ee,0x2e5,0x39c)]]=_0x5998f3);function _0x5c5aca(_0x54775e,_0x11855a,_0x11597d,_0x3472d5){return _0x5357(_0x3472d5-0x24f,_0x54775e);}if(_0x56d707){if(_0xcf460d[_0x5c5aca(0x4cf,0x4e7,0x495,0x50a)](_0xcf460d[_0x2df53a(-0xb4,0x84,0x12,0x34)],_0xcf460d[_0x2df53a(0x1bc,0x1be,0x156,0x21e)]))_0x2a1c05[_0xcf460d['TskLz']]=_0x56d707;else{if(_0x45787a){const _0x1e16c3=_0x1add25[_0x2df53a(-0x2d,0x8f,-0x18,-0xec)](_0x5054ac,arguments);return _0x48f740=null,_0x1e16c3;}}}return _0x2a1c05;}function _0x5357(_0x23aaaf,_0x4847a9){_0x23aaaf=_0x23aaaf-(-0x1def+0x1b91*-0x1+0x28e*0x17);const _0x3321ba=_0x5513();let _0x4ac7fb=_0x3321ba[_0x23aaaf];if(_0x5357['XDuNen']===undefined){var _0x3cba8b=function(_0x33c306){const _0x5353b6='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x430b5e='',_0x33097e='',_0x18d8f1=_0x430b5e+_0x3cba8b;for(let _0xed2748=0x3*-0x7ae+0x57*0x71+-0xab*0x17,_0x1814c0,_0x19146e,_0x55d27c=-0x1713+0x1680+0x93;_0x19146e=_0x33c306['charAt'](_0x55d27c++);~_0x19146e&&(_0x1814c0=_0xed2748%(-0x1069*-0x2+0xa*-0x2df+-0x8*0x83)?_0x1814c0*(-0x4d6*0x6+-0x1974+0x8*0x6d7)+_0x19146e:_0x19146e,_0xed2748++%(0x49*0x50+-0x2115+0xa49))?_0x430b5e+=_0x18d8f1['charCodeAt'](_0x55d27c+(0x1ddb*0x1+0x111*-0x10+-0x1*0xcc1))-(0x1d0a+0x1*0x1d83+0x3*-0x1381)!==0x72*-0x4f+0x164e+0xce0?String['fromCharCode'](0x119c+0x41*0x4e+-0x246b&_0x1814c0>>(-(-0x1526+0x443*0x2+-0x7*-0x1ce)*_0xed2748&0x1*0x2177+0x63a+-0x7ef*0x5)):_0xed2748:0xe4b*-0x1+-0x1ba5*-0x1+-0xd5a*0x1){_0x19146e=_0x5353b6['indexOf'](_0x19146e);}for(let _0x47e464=-0x7*-0x3fb+0x1443+0x2c*-0x118,_0x1529e5=_0x430b5e['length'];_0x47e464<_0x1529e5;_0x47e464++){_0x33097e+='%'+('00'+_0x430b5e['charCodeAt'](_0x47e464)['toString'](0x1*0xb2d+0x2170+0x2c8d*-0x1))['slice'](-(-0x1e42+-0x3ad*0x9+-0x1*-0x3f59));}return decodeURIComponent(_0x33097e);};_0x5357['tnCGBW']=_0x3cba8b,_0x5357['VekAdR']={},_0x5357['XDuNen']=!![];}const _0x30c849=_0x3321ba[-0x1*-0xc19+-0x4*0x198+-0x1*0x5b9],_0x4d68d3=_0x23aaaf+_0x30c849,_0x3bbbef=_0x5357['VekAdR'][_0x4d68d3];if(!_0x3bbbef){const _0x355e84=function(_0x225229){this['XmHPia']=_0x225229,this['jFcKdQ']=[0x135*0x5+0x7b3+-0xdbb*0x1,0x7de+-0x3f*0x49+0xa19,-0x86a+0x1f95+0x1*-0x172b],this['lhEkzS']=function(){return'newState';},this['vThRfP']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['dnpYzW']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x355e84['prototype']['FTlFuL']=function(){const _0x15c236=new RegExp(this['vThRfP']+this['dnpYzW']),_0x2d5285=_0x15c236['test'](this['lhEkzS']['toString']())?--this['jFcKdQ'][0x169*0x12+0x17c5+0x2*-0x1893]:--this['jFcKdQ'][0xb53*-0x1+-0x3*-0x2fc+-0x1*-0x25f];return this['nbmENA'](_0x2d5285);},_0x355e84['prototype']['nbmENA']=function(_0x25f026){if(!Boolean(~_0x25f026))return _0x25f026;return this['jCgVMo'](this['XmHPia']);},_0x355e84['prototype']['jCgVMo']=function(_0x52dbc6){for(let _0x1c8209=-0x15b5*-0x1+0x20d0+-0x3685,_0x29dd81=this['jFcKdQ']['length'];_0x1c8209<_0x29dd81;_0x1c8209++){this['jFcKdQ']['push'](Math['round'](Math['random']())),_0x29dd81=this['jFcKdQ']['length'];}return _0x52dbc6(this['jFcKdQ'][-0xb*-0x30d+0x60*-0x4b+-0x56f]);},new _0x355e84(_0x5357)['FTlFuL'](),_0x4ac7fb=_0x5357['tnCGBW'](_0x4ac7fb),_0x5357['VekAdR'][_0x4d68d3]=_0x4ac7fb;}else _0x4ac7fb=_0x3bbbef;return _0x4ac7fb;}let currentTaskId=null,currentRequestId=null,currentPrompt=null;async function getImageFromTurnData(_0x1c7131){const _0xe3723c={'hhpiF':_0x3a8663(0x32,-0x13f,-0x9e,-0x13a)+_0x3a8663(-0xa7,0x84,-0x44,-0xec)+'\x20NT\x2010.0;\x20'+_0x374696(0x454,0x466,0x4fe,0x5c1)+_0x3a8663(0x1,0x11c,0x4c,-0xe)+_0x3a8663(-0x39,-0x75,-0x8b,0x8)+'\x20(KHTML,\x20l'+_0x374696(0x456,0x4bf,0x49c,0x3d2)+_0x374696(0x4ff,0x429,0x4bb,0x574)+_0x3a8663(0xcd,0x2a,0x1d,0x9c)+'fari/537.3'+'6','TXgzA':_0x3a8663(0x1d,-0x135,-0xaf,-0xe9),'vzjth':_0x374696(0x53a,0x50c,0x4d2,0x502)+'pe','BFzOY':'cfgimg_','GnWPW':function(_0x299b18,_0x8aeddc){return _0x299b18===_0x8aeddc;},'fJWYx':'leOwg','TOLqd':function(_0x14ceeb,_0x2b56b7){return _0x14ceeb(_0x2b56b7);},'lrLgI':function(_0x59c331,_0x51dc1a){return _0x59c331||_0x51dc1a;},'jaGcl':_0x3a8663(-0xd1,-0xb4,-0x52,0x1e)};function _0x374696(_0x4deeb2,_0x5a1b74,_0x443335,_0x4190dd){return _0x5357(_0x443335-0x33c,_0x4deeb2);}if(!_0x1c7131)return'';if(_0x1c7131[_0x374696(0x48c,0x5b9,0x510,0x48d)]&&_0x1c7131['imageId'][_0x3a8663(-0xa2,-0x9c,-0xab,-0x121)](_0xe3723c[_0x3a8663(-0xd4,-0x159,-0x9d,-0x14d)])){if(_0xe3723c['GnWPW'](_0x374696(0x58d,0x55c,0x4c0,0x4d0),_0xe3723c['fJWYx'])){const _0x3ef9cf={};_0x3ef9cf[_0x3a8663(0x21,-0x5e,0x72,-0x52)]=_0xe3723c[_0x3a8663(-0x9a,-0x76,-0x71,-0x1b)],_0x3ef9cf[_0x374696(0x678,0x5f1,0x5d9,0x662)]=_0xe3723c[_0x374696(0x597,0x5bb,0x538,0x59b)];const _0x19de4c=_0x3ef9cf;return _0x99e424&&(_0x19de4c[_0xe3723c[_0x3a8663(0x1f,0xba,0xa9,0x65)]]=_0x4b3d18),_0x47dc98&&(_0x19de4c[_0x374696(0x611,0x501,0x54c,0x591)+_0x374696(0x624,0x62b,0x5ed,0x648)]=_0x460c8f),_0x19de4c;}else{const _0x3cc27a=await _0xe3723c['TOLqd'](getConfigImage,_0x1c7131[_0x374696(0x594,0x50c,0x510,0x4af)]);return _0xe3723c['lrLgI'](_0x3cc27a,'');}}function _0x3a8663(_0x2c7b23,_0x3b1284,_0x183e9f,_0x3e7a46){return _0x5357(_0x183e9f- -0x204,_0x2c7b23);}if(_0x1c7131[_0x374696(0x55c,0x4c2,0x4d6,0x5ad)]&&_0x1c7131[_0x374696(0x566,0x54e,0x4d6,0x50a)][_0x3a8663(0x8,-0xeb,-0xab,-0xf9)](_0xe3723c[_0x374696(0x54f,0x549,0x572,0x5c1)]))return _0x1c7131['image'];return'';}async function generateBananaImage({prompt:_0x20467d,width:_0x11a8ca,height:_0x41ca6d,change:_0x3843b6,retouchPrompt:_0x3eabc3,retouchImage:_0x56f6fc}){const _0x1e235b={'OoSMN':function(_0x1cbccd,_0x294afc){return _0x1cbccd+_0x294afc;},'nfIPL':_0x2bf970(0x5d6,0x704,0x63e,0x653),'EIgFK':'assistant','WJIMG':function(_0x12114a,_0x497fa9){return _0x12114a(_0x497fa9);},'ZhjPa':'[Banana]\x20F'+_0xe43dff(-0x6a,-0xcf,-0xe0,-0x20)+':','IRfuX':function(_0x159494,_0x27a6cd){return _0x159494===_0x27a6cd;},'nCyjX':_0xe43dff(0x10,-0x42,-0x17c,-0xbf),'huMNL':function(_0x5d681e){return _0x5d681e();},'vyHIE':function(_0x1a7292,_0x3e36c9){return _0x1a7292(_0x3e36c9);},'YPCsO':_0x2bf970(0x5c6,0x530,0x538,0x58d)+_0x2bf970(0x59f,0x56a,0x53d,0x574)+_0x2bf970(0x54d,0x4e0,0x597,0x4ef)+_0xe43dff(-0xf5,-0x5b,-0x103,-0xe6)+'mage\x20from\x20'+_0x2bf970(0x51d,0x4f8,0x50b,0x562),'rYHoF':'(((.+)+)+)'+'+$','zarQn':_0xe43dff(-0x1d,0xb,-0xa1,-0x5b)+_0xe43dff(0xba,0x76,0xc7,-0xd)+'ana_task','AVxci':_0xe43dff(-0xc7,-0xec,-0x19c,-0xce)+_0xe43dff(0xa9,-0xc4,-0x18,-0x14),'HovWI':_0xe43dff(-0x1ac,-0xa9,-0x240,-0x16c),'xbLcw':_0xe43dff(-0x15d,-0xbb,-0x173,-0x135),'FeVjy':_0x2bf970(0x4ba,0x59c,0x599,0x55d)+_0xe43dff(-0x10c,-0x159,-0x94,-0x146)+'。','PqtHq':function(_0x9fe35d,_0x5c33f8){return _0x9fe35d||_0x5c33f8;},'pbwbg':'2|1|3|4|0','WOYxc':function(_0x2afd96,_0x1e8ac3){return _0x2afd96===_0x1e8ac3;},'dxWbh':_0x2bf970(0x713,0x6d7,0x5ed,0x678),'VGCkX':_0xe43dff(-0xd2,-0xc1,-0x174,-0x169),'dpefc':function(_0x15f244,_0x3039b8){return _0x15f244(_0x3039b8);},'EpdeA':_0xe43dff(0x1a,-0xb4,-0x28,-0x91),'byHZR':function(_0x25fceb,_0x1ef461){return _0x25fceb(_0x1ef461);},'cdbAm':function(_0x5f51a9,_0x8832e7){return _0x5f51a9||_0x8832e7;},'VKSBx':function(_0xfaa37d,_0xa6b821){return _0xfaa37d>_0xa6b821;},'NYbZn':_0x2bf970(0x5a6,0x5ad,0x520,0x586),'XCDzD':function(_0x4babbb,_0x1eb697){return _0x4babbb(_0x1eb697);},'RQcId':function(_0x5e52e9,_0x32aadc){return _0x5e52e9(_0x32aadc);},'QsTAP':function(_0x231292,_0x22b279){return _0x231292(_0x22b279);},'aRObN':function(_0x4038c8,_0x242f22){return _0x4038c8(_0x242f22);},'XJWJb':'Scene\x20Comp'+_0xe43dff(0xc0,0xa1,0x61,-0x13),'gDSeP':_0xe43dff(-0x5f,-0x3c,-0x16c,-0x98),'jtPmU':function(_0x12959f,_0x3e4df9){return _0x12959f(_0x3e4df9);},'lcwJX':function(_0xc847f1,_0x464f22){return _0xc847f1!==_0x464f22;},'PIzTV':_0x2bf970(0x55b,0x4a3,0x496,0x4cc),'GSLvL':'avNPq','mdBmx':function(_0x1513fd,_0x290c79,_0x13ad0b){return _0x1513fd(_0x290c79,_0x13ad0b);},'JfSui':function(_0x17b902,_0x2047b1){return _0x17b902<=_0x2047b1;},'CMoBL':function(_0x42165f,_0x46692c){return _0x42165f+_0x46692c;},'ykwmy':function(_0x5ac356,_0x92ee00){return _0x5ac356(_0x92ee00);},'TbFsA':_0x2bf970(0x691,0x5ca,0x664,0x5c3),'AWIQi':function(_0x3a7b60,_0x3b7fea){return _0x3a7b60===_0x3b7fea;},'dhEEz':_0x2bf970(0x570,0x4b6,0x4b4,0x53c),'FSNpW':'前置前','EnMHQ':_0x2bf970(0x5f1,0x5a4,0x5a1,0x601),'ksQLg':_0xe43dff(-0xf8,-0x12f,-0x12b,-0x13a),'JdNKS':_0xe43dff(-0x138,-0x1f,-0xc9,-0xdd),'OoFDP':_0xe43dff(-0x16f,-0x168,-0x1d9,-0x12e),'XzkZF':function(_0x484574,_0x56f76c){return _0x484574(_0x56f76c);},'TRwDk':_0x2bf970(0x564,0x4f4,0x572,0x51a),'CATmI':function(_0x4a325f,_0x298dd4){return _0x4a325f(_0x298dd4);},'gpoFn':function(_0xa4e71f,_0x5baefd){return _0xa4e71f(_0x5baefd);},'JXNrO':function(_0x2005e0,_0x3130d6){return _0x2005e0(_0x3130d6);},'FvLKW':_0x2bf970(0x70a,0x6c8,0x59d,0x674),'eUWtG':function(_0x4996c5,_0x15e2e4){return _0x4996c5(_0x15e2e4);},'qOwOr':_0x2bf970(0x66f,0x66e,0x615,0x5fb),'dLjDF':_0x2bf970(0x512,0x513,0x581,0x5aa),'uzNRn':_0xe43dff(0x22,-0x50,-0x88,0xc),'CAEAj':_0x2bf970(0x5f3,0x60f,0x6ff,0x661),'fVLps':_0xe43dff(-0x28,0x1d,-0x2a,-0x9e),'oWCbo':'qpOtt','iUpNj':_0xe43dff(-0x1bd,-0xda,-0xc5,-0x114),'seuim':function(_0x4bfc4e,_0x478c35){return _0x4bfc4e!==_0x478c35;},'Voxoc':_0xe43dff(-0x131,0x3c,-0x14f,-0x89),'hvguo':function(_0x332366,_0x22a823){return _0x332366(_0x22a823);},'EOPOg':'XgeIb','xqTsL':_0x2bf970(0x5e5,0x6d4,0x5ca,0x627),'CkUny':function(_0x43c60e,_0x277d4f){return _0x43c60e(_0x277d4f);},'uBxhx':_0x2bf970(0x418,0x4b7,0x4ed,0x4d5),'lCRGS':_0x2bf970(0x599,0x610,0x611,0x5f0),'Eoxya':'PvxwL','McpLa':_0xe43dff(-0x31,0x23,0x3d,-0x85),'etXvY':function(_0x1c8f87,_0x1048d4){return _0x1c8f87+_0x1048d4;},'bXSHv':'jiuguan','dsRCF':_0x2bf970(0x50a,0x522,0x5c4,0x5ca),'Henap':function(_0x584f27,_0x6a07b1){return _0x584f27===_0x6a07b1;},'xcqFc':'YRmYN','fEQKP':_0x2bf970(0x6d5,0x68a,0x6f9,0x651),'hggDh':function(_0x20b7ab,_0x176943){return _0x20b7ab!==_0x176943;},'EUjYK':_0x2bf970(0x67a,0x631,0x691,0x608),'vkepl':_0xe43dff(-0x12f,-0x23a,-0x225,-0x15e),'WpPhZ':function(_0x55d425,_0x31afcb){return _0x55d425(_0x31afcb);},'ENPfI':'applicatio'+_0x2bf970(0x5b5,0x5c7,0x58c,0x62b),'fPeaS':function(_0x1e321b,_0x2abbc0){return _0x1e321b===_0x2abbc0;},'wbmoH':_0x2bf970(0x56c,0x6b5,0x6b7,0x5ef),'xdrTJ':_0x2bf970(0x56e,0x5b7,0x5ca,0x61f),'dqBEM':_0x2bf970(0x583,0x684,0x5d1,0x65b),'svKZf':_0xe43dff(-0x69,-0xaf,-0x6b,-0x6c),'yUdCx':function(_0x40efb1,_0x26085e){return _0x40efb1===_0x26085e;},'rzOob':_0x2bf970(0x532,0x4bc,0x585,0x58b),'TzhBb':function(_0x10aa1e,_0x5302ae){return _0x10aa1e===_0x5302ae;},'QxBAl':'WvHbu','msSlc':_0xe43dff(-0xb7,0x62,0x1b,-0x66),'NldPo':_0xe43dff(-0x10,-0x2e,-0xc6,-0x95),'THmgq':_0x2bf970(0x568,0x527,0x5db,0x5df),'IJQzX':'data:image'+'/','IOJgI':_0xe43dff(-0x62,0x50,0x61,-0x58)+_0xe43dff(-0x10d,-0x23c,-0x13c,-0x160)+_0x2bf970(0x5b4,0x537,0x549,0x4e5)+_0x2bf970(0x634,0x623,0x4f8,0x568)+_0xe43dff(-0x159,-0x22e,-0x104,-0x153),'CHGGZ':function(_0x16db43,_0x1b71bd){return _0x16db43(_0x1b71bd);},'ipBeu':'GVyTv','CAlbu':_0x2bf970(0x709,0x646,0x709,0x66e),'CvIbC':function(_0x298b86,_0x36b61f){return _0x298b86(_0x36b61f);},'TMdTc':'true','RjrQd':function(_0x1f21bd,_0x48d14b){return _0x1f21bd(_0x48d14b);},'WACXI':function(_0x418072,_0x5023be){return _0x418072(_0x5023be);},'hEODY':_0x2bf970(0x633,0x546,0x4bd,0x58d)+_0x2bf970(0x4c0,0x569,0x609,0x574)+_0xe43dff(-0xc6,-0x13b,-0x16e,-0x13d)+_0xe43dff(-0xc9,-0x5b,-0x64,-0x4e)+_0x2bf970(0x5a5,0x683,0x4fb,0x5ae)+_0xe43dff(-0x15f,-0x1af,-0x36,-0xfe),'zagWV':function(_0x51c102,_0x516dc4){return _0x51c102!==_0x516dc4;},'WZqmW':function(_0x39d909,_0x4274bd){return _0x39d909(_0x4274bd);},'abFyM':function(_0x4209fd,_0x47b329){return _0x4209fd(_0x47b329);},'DXbwm':'[Banana]\x20R'+'esponse\x20co'+_0xe43dff(-0x126,-0x30,-0xbc,-0x59)+'t\x20only,\x20no'+_0xe43dff(-0xca,-0x13c,-0x165,-0x14e),'wbEZq':_0x2bf970(0x691,0x66d,0x603,0x615)+_0x2bf970(0x5bb,0x45e,0x579,0x518)+'\x20contain\x20i'+_0x2bf970(0x5d0,0x545,0x63b,0x582)+_0xe43dff(-0x12f,-0x108,-0x19e,-0xc5)+'t','pZOkY':_0x2bf970(0x5ae,0x6f5,0x656,0x636)+_0x2bf970(0x69d,0x50f,0x61d,0x5da)+_0xe43dff(0x42,0xb,-0x41,-0x3a)+'ssfully.','Piusn':_0x2bf970(0x524,0x567,0x58a,0x51e),'AfRFM':function(_0x27154e,_0x3d97a7){return _0x27154e(_0x3d97a7);}};clearLog();const _0x3f8a74=taskQueue[_0xe43dff(-0x1a7,-0x7f,-0x17a,-0x141)]({'name':_0x1e235b['OoSMN'](_0x1e235b['cdbAm'](_0x20467d,'')[_0x2bf970(0x529,0x64e,0x520,0x592)](0x3*0x17b+0x1*-0x193b+0x14ca,-0x1080+-0x38*-0x26+-0x427*-0x2),_0x20467d&&_0x1e235b[_0x2bf970(0x66f,0x610,0x68e,0x61b)](_0x20467d[_0x2bf970(0x5f9,0x567,0x4b1,0x534)],0x2c0+0xfc1+-0x1263)?_0x1e235b[_0xe43dff(0x2c,-0x29,-0x2a,-0xa9)]:''),'type':TaskType[_0xe43dff(0x57,0x77,-0x38,-0x48)],'prompt':_0x20467d});currentTaskId=_0x3f8a74,_0x20467d=_0x1e235b[_0x2bf970(0x608,0x4db,0x668,0x5b6)](processCharacterPrompt,_0x20467d),_0x20467d=await _0x1e235b['XCDzD'](stripChineseAnnotations,_0x20467d);let _0x1111b3=_0x3843b6;_0x3843b6=_0x1e235b[_0xe43dff(-0x10f,-0x1a,-0x5f,-0x88)](processCharacterPrompt,_0x3843b6),_0x3843b6=await stripChineseAnnotations(_0x3843b6),_0x1e235b[_0xe43dff(-0x42,-0x81,-0xe1,-0x8e)](addLog,_0x2bf970(0x5bc,0x661,0x634,0x5a5)+_0x2bf970(0x63a,0x68b,0x5ea,0x5e6)+extension_settings[extensionName][_0x2bf970(0x649,0x648,0x5bf,0x641)]),_0x1e235b[_0xe43dff(0x83,0x28,-0x11e,-0x46)](addLog,_0xe43dff(-0x1b6,-0x16d,-0x13a,-0x11b)+'\x20'+_0x1e235b[_0x2bf970(0x6a7,0x671,0x5fa,0x5db)](_0x11a8ca,'默认')+_0xe43dff(-0x56,-0xf5,-0xac,-0x116)+_0x1e235b['cdbAm'](_0x41ca6d,'默认')),_0x20467d=_0x3843b6&&_0x3843b6[_0xe43dff(-0x4e,-0x5d,0x0,-0x2a)]()!==''?_0x3843b6:_0x20467d,_0x1e235b['aRObN'](addLog,_0x2bf970(0x638,0x6e8,0x5b3,0x612)+_0x20467d);let _0x4fdfdd=![];if(_0x20467d[_0xe43dff(-0x79,0x4b,-0x81,0x28)](_0x1e235b[_0x2bf970(0x6cb,0x660,0x6c0,0x659)])){if(_0x1e235b[_0x2bf970(0x547,0x4fa,0x556,0x510)](_0xe43dff(-0x77,0x7,0xbe,0x22),_0x1e235b[_0x2bf970(0x5a8,0x699,0x6e4,0x623)]))return _0x5293aa[_0x2bf970(0x480,0x5df,0x4a3,0x51b)];else _0x4fdfdd=!![];}addLog(_0x2bf970(0x505,0x482,0x4a1,0x50e)+_0xe43dff(-0x131,-0xd7,-0x6a,-0x78)+_0xe43dff(0x4e,-0xce,-0xe6,-0x6b)+_0x4fdfdd);let _0xd54983={},_0x2b2c68='',_0x14a6ee='';if(_0x4fdfdd){_0x1e235b['XCDzD'](addLog,_0x2bf970(0x550,0x552,0x48e,0x566)+_0x2bf970(0x434,0x56a,0x45f,0x4fb)),_0xd54983=_0x1e235b['jtPmU'](parsePromptStringWithCoordinates,_0x20467d),_0x2b2c68=_0xd54983[_0x1e235b[_0xe43dff(-0xb3,0x4a,0x4a,0x15)]];for(let _0x465ff2=-0x2327*0x1+0x1f87+0x3a1;_0x465ff2<=0x18a2+0x2b1*0xe+-0x3e4c;_0x465ff2++){_0x1e235b[_0x2bf970(0x48a,0x56c,0x4e7,0x4cb)](_0x1e235b[_0xe43dff(-0xec,-0x25,-0x4d,-0xbb)],_0x1e235b[_0x2bf970(0x558,0x4fd,0x5e6,0x589)])?_0x5538b1=_0x524153:_0xd54983[_0xe43dff(0x14,0x1a,-0xb4,0x19)+_0x465ff2+'\x20Prompt']&&(_0x14a6ee=_0x1e235b[_0x2bf970(0x5cb,0x552,0x58d,0x531)](_0x14a6ee,',\x20')+_0xd54983[_0x2bf970(0x737,0x5ae,0x6b3,0x65d)+_0x465ff2+_0x2bf970(0x590,0x52f,0x54d,0x4f8)]);}}else _0x1e235b[_0xe43dff(-0x61,-0x172,-0x11f,-0x10e)](_0x1e235b[_0x2bf970(0x649,0x5c6,0x52a,0x579)],_0x2bf970(0x616,0x496,0x557,0x53d))?(addLog(_0x2bf970(0x4fe,0x554,0x47a,0x4f7)+_0x2bf970(0x64e,0x649,0x60b,0x577)),_0x2b2c68=_0x20467d):_0x4833c7=_0x1e235b['OoSMN'](_0x5e4a17,_0x1e235b[_0xe43dff(-0x136,-0x196,-0x10b,-0xec)]);let {modifiedPrompt:_0x3170d3,insertions:_0x3d85e8}=await _0x1e235b[_0x2bf970(0x5e3,0x600,0x551,0x5b0)](prompt_replace,_0x2b2c68,_0x14a6ee);if(_0x4fdfdd)for(let _0x39f56b=0x1457+0x676+-0x1acc;_0x1e235b[_0x2bf970(0x5de,0x5eb,0x4a4,0x512)](_0x39f56b,0x6a*0x5e+0xf2*0x10+-0x3608);_0x39f56b++){_0xd54983[_0x2bf970(0x71d,0x706,0x5f7,0x65d)+_0x39f56b+'\x20Prompt']&&(_0x3170d3=_0x1e235b['OoSMN'](_0x1e235b[_0xe43dff(0xb3,-0x49,0x6e,0x2)](_0x3170d3,_0x1e235b[_0x2bf970(0x594,0x53f,0x4a9,0x52f)]),_0x1e235b[_0x2bf970(0x5eb,0x592,0x654,0x5fe)](prompt_replace_for_character,_0xd54983['Character\x20'+_0x39f56b+_0x2bf970(0x524,0x5b4,0x4d0,0x4f8)])));}const _0x219e54=extension_settings[extensionName][_0xe43dff(-0x20d,-0x1a1,-0x1a1,-0x147)];function _0x2bf970(_0xf88446,_0x55ec45,_0x19a986,_0xa7f55e){return _0x5357(_0xa7f55e-0x381,_0x55ec45);}const {model:_0x87ed65,apiUrl:_0x400f0f,apiKey:_0x3c9895,conversationPresets:_0x1d156f,conversationPresetId:_0x26f6ff,editPresetId:_0x51c549,aspectRatio:_0x20a1ea}=_0x219e54;_0x1e235b[_0x2bf970(0x5d1,0x67c,0x62c,0x634)](addLog,_0xe43dff(0x5,-0x3c,0x1f,-0xb7)+_0xe43dff(0x25,-0x34,-0x13,-0x17)+_0xe43dff(-0x10e,-0x44,-0x61,-0x7c)+_0xe43dff(-0x181,-0x92,-0x204,-0x14b)+_0x2bf970(0x53a,0x5cd,0x5ab,0x5c5)+_0x87ed65);let _0x21fcdf,_0x544b1d;if(_0x87ed65[_0xe43dff(-0x1a4,-0xd9,-0x1e0,-0x16a)](_0x1e235b[_0xe43dff(0xad,0x52,0x37,0x9)])){if(_0x1e235b[_0xe43dff(-0x14e,-0x71,-0x187,-0xc0)](_0x1e235b[_0xe43dff(-0x18b,-0xf2,-0x177,-0xf7)],_0x1e235b[_0xe43dff(-0x154,-0xde,-0x1a2,-0xf7)])){_0x21fcdf=_0x2bf970(0x67c,0x58f,0x734,0x665)+_0x2bf970(0x424,0x559,0x530,0x4e0)+_0x87ed65;const _0x3af3c2={};_0x3af3c2[_0x2bf970(0x646,0x5ae,0x524,0x57a)+'t']='';const _0x485b5e=_0x1d156f[_0x26f6ff]||_0x3af3c2,_0x3a17e3=[_0x485b5e[_0x2bf970(0x5dd,0x648,0x52f,0x57a)+'t'],_0x3d85e8[_0x1e235b['FSNpW']],_0x3d85e8[_0x1e235b[_0x2bf970(0x6ba,0x58f,0x5fe,0x5e8)]],_0x3170d3,_0x3d85e8[_0x1e235b[_0xe43dff(0x41,-0xdb,0x2f,-0x3f)]],_0x3d85e8[_0x1e235b[_0xe43dff(-0x184,-0x6f,-0x1c1,-0x128)]],_0x485b5e[_0x2bf970(0x58f,0x5e3,0x5aa,0x525)+'mpt'],_0x3d85e8[_0x1e235b['OoFDP']]]['filter'](Boolean)[_0xe43dff(-0x88,-0x128,-0x71,-0xf4)](',\x20');_0x1e235b['RQcId'](addLog,'正面提示词:\x20'+_0x3a17e3);const _0x4b6673={};_0x4b6673['prompt']=_0x3a17e3;const _0x36f7f5={};_0x36f7f5[_0x2bf970(0x4de,0x570,0x583,0x5b2)+'t']=0x1,_0x36f7f5[_0xe43dff(-0x1e2,-0xc7,-0xa5,-0x161)+'o']=_0x20a1ea;const _0x81a279={};_0x81a279[_0x2bf970(0x599,0x4c1,0x4c0,0x4ed)]=[_0x4b6673],_0x81a279[_0x2bf970(0x6bc,0x621,0x58b,0x5f9)]=_0x36f7f5,_0x544b1d=_0x81a279,_0x1e235b[_0xe43dff(-0xd2,-0xac,-0x27,-0x33)](addLog,_0x2bf970(0x5c8,0x592,0x5b7,0x535)+_0x2bf970(0x59e,0x5dd,0x532,0x5c6)+_0x2bf970(0x5e3,0x514,0x4da,0x5a0)+_0x2bf970(0x5d2,0x627,0x511,0x599)+'t:\x20'+_0x3a17e3);}else{const _0x384a6b={};_0x384a6b[_0xe43dff(-0x6,-0x1f,0x18,-0x6)]=_0x1e235b[_0x2bf970(0x509,0x496,0x520,0x544)],_0x384a6b['content']=_0x239bfb,_0x50b27f[_0xe43dff(-0x15d,-0x156,-0x15f,-0xe9)](_0x384a6b);}}else{if(_0x1e235b[_0x2bf970(0x5a7,0x596,0x5b2,0x4ff)]!==_0x1e235b[_0xe43dff(-0xb1,-0xba,-0x97,-0x145)]){const _0x5f19be=_0xe43dff(-0xaa,-0xd4,0x52,-0x44)[_0x2bf970(0x4d0,0x547,0x53c,0x580)]('|');let _0x19ff9e=-0x646+0x2569+-0x1f23;while(!![]){switch(_0x5f19be[_0x19ff9e++]){case'0':_0x50616f=null;continue;case'1':throw _0x3b0a1f;continue;case'2':_0x1e235b[_0xe43dff(0x5c,0x9c,-0x3f,0x4)](_0x35b561,_0xe43dff(-0xc8,-0x93,-0x17d,-0xd7)+_0xe43dff(-0x68,-0x7a,0x27,-0x20)+':\x20'+_0x346bf8[_0x2bf970(0x4f7,0x5fb,0x547,0x58f)]);continue;case'3':_0x52362d[_0x2bf970(0x6a1,0x68f,0x6c1,0x644)](_0x1e235b[_0xe43dff(0xcf,-0x29,-0x45,-0x1)],_0x492ce2);continue;case'4':if(_0x1e235b[_0x2bf970(0x441,0x5b1,0x511,0x510)](_0x5d4709[_0xe43dff(-0x191,-0x96,-0x10d,-0xb5)],_0x1e235b[_0x2bf970(0x529,0x61f,0x4ef,0x55f)])){}else _0x182392[_0x2bf970(0x5cd,0x60a,0x57f,0x571)+'sk'](_0x3c54f0,![]);continue;}break;}}else{_0x21fcdf=_0xe43dff(-0x90,-0x12d,-0x18,-0xe8)+_0xe43dff(-0x22,-0x73,0x9e,-0x1b);let _0x362261;if(_0x3843b6[_0xe43dff(0x8d,0xba,0x68,0x28)](_0xe43dff(-0x94,-0x91,-0x65,-0x49))){_0x1e235b[_0x2bf970(0x520,0x5ec,0x69a,0x5d6)](addLog,_0x1e235b[_0xe43dff(-0x40,0x53,-0xa2,-0x5)]);const _0x19ec40=_0x1e235b[_0x2bf970(0x4a7,0x638,0x50d,0x565)](_0x51c549,'默认'),_0x4e2b05={};_0x4e2b05['conversati'+'on']=[],_0x4e2b05[_0x2bf970(0x574,0x541,0x5da,0x57a)+'t']='',_0x362261=_0x1d156f[_0x19ec40]||_0x4e2b05,addLog(_0xe43dff(-0x88,-0x43,-0x47,-0xf2)+'用修图预设:\x20\x22'+_0x19ec40+'\x22');}else{const _0x3f443f={};_0x3f443f[_0xe43dff(-0x15a,-0xb,-0xe2,-0xb6)+'on']=[],_0x3f443f[_0xe43dff(-0xd6,-0x35,-0x61,-0xca)+'t']='',_0x362261=_0x1d156f[_0x26f6ff]||_0x3f443f;}const _0x9039f4=[_0x362261[_0xe43dff(-0x126,-0x103,-0x96,-0xca)+'t'],_0x3d85e8[_0x1e235b['FSNpW']],_0x3d85e8[_0xe43dff(0x20,-0x106,0x24,-0x43)],_0x3170d3,_0x3d85e8[_0x1e235b[_0x2bf970(0x5b5,0x683,0x5f4,0x605)]],_0x3d85e8[_0x1e235b[_0xe43dff(-0x73,-0x1f3,-0x118,-0x128)]],_0x362261['postfixPro'+_0xe43dff(0x46,0x1a,-0x22,-0x7d)],_0x3d85e8[_0xe43dff(-0xd0,-0xce,-0xee,-0x12e)]]['filter'](Boolean)[_0xe43dff(-0x5e,-0x1a5,-0x1ab,-0xf4)](',\x20');_0x1e235b[_0x2bf970(0x698,0x680,0x609,0x625)](addLog,_0x2bf970(0x5b4,0x63e,0x51b,0x5a1)+_0x9039f4);const _0x1d37c1={};_0x1d37c1[_0xe43dff(0x25,0x18,0x71,-0x6)]=_0x2bf970(0x4ea,0x538,0x401,0x4d8),_0x1d37c1[_0xe43dff(0x12,-0x10a,-0x122,-0xa1)]=[];const _0x16c9b7={};_0x16c9b7[_0x2bf970(0x64d,0x6b3,0x64e,0x63e)]=_0xe43dff(0x3,0x61,-0xa0,0x35),_0x16c9b7[_0xe43dff(0x34,-0x109,-0x96,-0xa1)]=[];const _0x5bc6d5=_0x362261[_0x2bf970(0x5a8,0x57b,0x53e,0x58e)+'on'][_0xe43dff(-0x164,-0xf7,0xc,-0x8b)](_0x33edfb=>[_0x1d37c1,_0x16c9b7])[_0xe43dff(0x22,-0x19,0x39,-0x41)]();let _0xf51709=-0xe61+0x2267*0x1+-0xa03*0x2;for(const _0x4888e5 of _0x362261['conversati'+'on']){if(_0x4888e5['user']?.[_0xe43dff(-0x203,-0xc9,-0xe5,-0x135)])_0x5bc6d5[_0xf51709][_0xe43dff(-0x24,-0xc5,-0x107,-0xa1)][_0xe43dff(-0x117,-0x6b,-0x13d,-0xe9)]({'type':_0xe43dff(-0x1da,-0x84,-0x1f3,-0x135),'text':_0x4888e5[_0xe43dff(-0x12c,-0x150,-0x199,-0x16c)][_0xe43dff(-0x1e2,-0x197,-0x10d,-0x135)]});const _0x3b3ff2=await _0x1e235b[_0xe43dff(-0x30,0x3a,-0x39,0x14)](getImageFromTurnData,_0x4888e5[_0xe43dff(-0x138,-0x1ac,-0x14b,-0x16c)]);if(_0x3b3ff2)_0x5bc6d5[_0xf51709]['content'][_0x2bf970(0x5d1,0x480,0x4cd,0x55b)]({'type':_0x1e235b[_0xe43dff(-0xd6,-0x1c8,-0xb6,-0xf8)],'image_url':{'url':_0x3b3ff2}});_0xf51709++;if(_0x4888e5[_0xe43dff(0x18,-0x7,-0x7f,-0x3b)]?.[_0x2bf970(0x483,0x59a,0x592,0x50f)])_0x5bc6d5[_0xf51709][_0x2bf970(0x5f9,0x554,0x598,0x5a3)][_0xe43dff(-0x24,-0x105,-0x100,-0xe9)]({'type':_0x1e235b[_0xe43dff(0x21,-0x33,-0x66,-0x9c)],'text':_0x4888e5[_0xe43dff(-0x114,-0x96,-0x26,-0x3b)][_0x2bf970(0x554,0x4f2,0x57a,0x50f)]});const _0x2dc8d1=await _0x1e235b[_0xe43dff(-0x23d,-0xfa,-0x1c1,-0x17b)](getImageFromTurnData,_0x4888e5['model']);if(_0x2dc8d1)_0x5bc6d5[_0xf51709][_0xe43dff(-0x3b,-0x11d,-0x8f,-0xa1)][_0x2bf970(0x5c0,0x56b,0x5fb,0x55b)]({'type':_0x1e235b['FvLKW'],'image_url':{'url':_0x2dc8d1}});_0xf51709++;}if(!_0x3843b6[_0x2bf970(0x666,0x692,0x718,0x66c)](_0x1e235b[_0xe43dff(0x34,0x42,0x54,-0xb)])){if(_0x1e235b[_0x2bf970(0x543,0x413,0x5b3,0x4d7)]!==_0x1e235b[_0xe43dff(-0x4f,0x68,0x23,-0x23)]){const _0x5c78e0=extension_settings[extensionName][_0xe43dff(-0x100,-0x41,-0xbe,-0x2b)+'acterPrese'+'ts']||{};for(const _0x137fe4 in _0x5c78e0){const _0x2eec76=_0x5c78e0[_0x137fe4],_0x26db88=(_0x2eec76[_0xe43dff(-0x1b4,-0x12d,-0xe9,-0x11a)]||'')['split']('|')[_0x2bf970(0x649,0x65e,0x680,0x5ea)](_0x238094=>_0x238094[_0x2bf970(0x6eb,0x5bb,0x629,0x61a)]()!=='');for(const _0x56b06a of _0x26db88){if(_0x1e235b['CAEAj']!==_0x1e235b[_0x2bf970(0x4b7,0x44b,0x5bb,0x4f5)]){if(_0x9039f4['toLowerCas'+'e']()[_0xe43dff(0x7a,0x0,-0x2d,0x28)](_0x56b06a[_0x2bf970(0x51e,0x5fc,0x53b,0x5c0)+'e']())){if(_0x1e235b[_0x2bf970(0x691,0x57b,0x520,0x5f8)]===_0x1e235b[_0x2bf970(0x507,0x625,0x57c,0x593)])_0x1e235b[_0xe43dff(0xf,-0x6b,0x86,0x4)](_0x4cb389,_0xe43dff(-0x164,-0x109,-0x1bd,-0x14d)+_0x2bf970(0x4cc,0x4d9,0x61a,0x577)),_0x376553=_0x5074f6;else{addLog(_0xe43dff(-0xe7,-0xbe,-0x2d,-0xd7)+_0x2bf970(0x521,0x60e,0x51c,0x58c)+_0xe43dff(0x8e,-0xed,-0x94,-0x1c)+_0x2bf970(0x703,0x683,0x622,0x64a)+_0x56b06a+('\x22\x20from\x20pre'+_0x2bf970(0x57e,0x5ea,0x5a9,0x5dc))+_0x137fe4+'\x22.');const _0x1215dc=_0x2eec76[_0x2bf970(0x594,0x4c6,0x4db,0x58e)+'on'];if(_0x1215dc){if(_0x1e235b['seuim'](_0x1e235b[_0xe43dff(-0x81,-0xa8,-0x5a,-0xf0)],_0x1e235b[_0x2bf970(0x54a,0x53f,0x516,0x554)]))_0x3de97c[_0x2bf970(0x4a1,0x49a,0x598,0x572)+_0xe43dff(-0xd9,-0x14e,-0xe7,-0x170)+_0xe43dff(0x73,0xed,0x77,0x2d)]=!![],_0x1e235b[_0xe43dff(0xf0,0xb1,0x24,0x23)](_0x358487);else{const _0x98602d=[];if(_0x1215dc[_0x2bf970(0x462,0x4d7,0x477,0x4d8)]&&_0x1215dc[_0x2bf970(0x40b,0x4db,0x50f,0x4d8)][_0xe43dff(-0x200,-0x9e,-0x8c,-0x135)])_0x98602d[_0xe43dff(-0x17,-0x15e,-0x9e,-0xe9)]({'type':_0x2bf970(0x46f,0x5c0,0x435,0x50f),'text':_0x1215dc['user']['text']});const _0x4b3de6=await _0x1e235b[_0xe43dff(-0xea,-0xb3,-0x120,-0xbc)](getImageFromTurnData,_0x1215dc[_0xe43dff(-0x231,-0x125,-0x16a,-0x16c)]);if(_0x4b3de6)_0x98602d[_0xe43dff(-0x192,-0xcc,-0x198,-0xe9)]({'type':_0x1e235b[_0xe43dff(-0x69,-0x60,-0x11b,-0xf8)],'image_url':{'url':_0x4b3de6}});if(_0x1e235b[_0x2bf970(0x6cb,0x69a,0x6f2,0x61b)](_0x98602d['length'],-0x416+0x2217+-0x1e01)){const _0x19f720={};_0x19f720[_0xe43dff(0x87,0xa5,-0xe1,-0x6)]=_0x1e235b[_0x2bf970(0x596,0x629,0x537,0x56a)],_0x19f720[_0x2bf970(0x612,0x514,0x64c,0x5a3)]=_0x98602d,_0x5bc6d5['push'](_0x19f720);}const _0x5135b9=[];if(_0x1215dc[_0x2bf970(0x5fe,0x638,0x651,0x609)]&&_0x1215dc[_0xe43dff(-0xab,0x4e,-0x7a,-0x3b)]['text'])_0x5135b9[_0xe43dff(-0x40,-0x11e,-0x148,-0xe9)]({'type':_0x1e235b[_0x2bf970(0x536,0x5d1,0x525,0x5a8)],'text':_0x1215dc[_0x2bf970(0x68b,0x57f,0x6df,0x609)][_0x2bf970(0x438,0x5d2,0x458,0x50f)]});const _0x44ae39=await _0x1e235b['jtPmU'](getImageFromTurnData,_0x1215dc[_0x2bf970(0x69a,0x5f9,0x67f,0x609)]);if(_0x44ae39)_0x5135b9[_0xe43dff(-0x48,-0x6c,-0x4e,-0xe9)]({'type':_0xe43dff(-0x3d,0xd8,-0xb,0x30),'image_url':{'url':_0x44ae39}});if(_0x1e235b['VKSBx'](_0x5135b9[_0x2bf970(0x4a3,0x49c,0x56f,0x534)],0x168b+-0x65b*0x1+-0x1030)){if(_0x1e235b['EOPOg']!==_0x1e235b[_0x2bf970(0x659,0x591,0x646,0x58a)]){const _0x198235={};_0x198235[_0x2bf970(0x5a2,0x6c6,0x690,0x63e)]=_0x1e235b[_0x2bf970(0x534,0x5b4,0x4be,0x544)],_0x198235[_0xe43dff(0x37,-0x53,-0x7e,-0xa1)]=_0x5135b9,_0x5bc6d5[_0xe43dff(-0xea,-0x86,-0x139,-0xe9)](_0x198235);}else{const _0x16b9e9='[Banana]\x20G'+_0xe43dff(0x81,-0x9d,0xc1,0x1e)+'failed\x20for'+_0x2bf970(0x673,0x634,0x5be,0x5ba)+_0x4749aa+':\x20'+_0x5b1a30[_0xe43dff(-0x8a,-0x57,-0x5e,-0xb5)];_0x1434c4(_0x16b9e9),_0x53f61e[_0xe43dff(-0x93,-0x29,-0x7c,0x0)](_0x16b9e9);const _0x35e94e={};_0x35e94e['id']=_0x24eb9b,_0x35e94e['success']=![],_0x35e94e[_0xe43dff(0xd5,-0x22,0x42,0x0)]=_0x51f9bf[_0x2bf970(0x4f2,0x5fe,0x5ae,0x58f)],_0x35e94e[_0x2bf970(0x56e,0x4cd,0x609,0x542)]=_0x1cb54a,_0x5ae5cb[_0x2bf970(0x4c7,0x4ca,0x4a2,0x564)](_0x3d1d51['GENERATE_I'+_0x2bf970(0x5ca,0x5f5,0x5f0,0x638)+_0xe43dff(0x18,-0xb2,0x2f,-0x31)],_0x35e94e),_0x1e235b['vyHIE'](_0x3fe23e,'[Banana]\x20E'+'mitted\x20fai'+_0xe43dff(-0x21e,-0x11e,-0x82,-0x159)+'nse\x20for\x20ID'+':\x20'+_0x5a4072);}}}}break;}}}else _0x243397[_0x2946f0][_0x2bf970(0x540,0x5cc,0x42c,0x4fd)][_0x2bf970(0x56e,0x65c,0x542,0x5d5)]=0x121c+-0x4*-0x650+0x2b5b*-0x1,_0x1e235b['vyHIE'](_0x269cfd,_0xe43dff(-0x71,0x4b,-0x39,-0x3e)+_0xe43dff(-0x95,-0x1e2,-0xb5,-0x123)+_0x1a5e61[_0x2d420c][_0xe43dff(-0x130,-0x1ba,-0x1a9,-0x147)]['cishu']);}}}else _0x1e235b[_0xe43dff(0x6f,0x2e,-0x98,0x4)](_0x1be6e6,_0xe43dff(-0x52,0x3d,-0x7,-0x58)+_0x2bf970(0x4b6,0x591,0x495,0x4e4)+_0xe43dff(-0x22c,-0x227,-0x116,-0x15f)+'edded\x20base'+'64\x20image.'),_0x1a121e=_0x4175a9,_0x1e235b[_0xe43dff(-0xc6,0x67,0x1f,-0x18)](_0x38fbe3,_0x1e235b[_0x2bf970(0x4f9,0x67f,0x650,0x5cf)]);}if(!_0x3843b6[_0x2bf970(0x6fa,0x70f,0x600,0x66c)](_0x2bf970(0x52e,0x5a0,0x563,0x5fb))){const _0x422b4d={};_0x422b4d['type']=_0x1e235b['xbLcw'],_0x422b4d['text']=_0x9039f4;const _0x4cf3aa={};_0x4cf3aa['role']=_0xe43dff(-0x209,-0x177,-0x237,-0x16c),_0x4cf3aa[_0xe43dff(-0x15c,-0x88,-0x5,-0xa1)]=[_0x422b4d],_0x5bc6d5[_0x2bf970(0x492,0x499,0x4e4,0x55b)](_0x4cf3aa);}else{const _0x498886=[],_0x134461=_0x1e235b[_0x2bf970(0x59f,0x595,0x547,0x565)](_0x3eabc3,_0x9039f4),_0x4a57b1=[_0x362261['fixedPromp'+'t'],_0x134461,_0x362261['postfixPro'+_0x2bf970(0x517,0x5bb,0x508,0x5c7)]][_0x2bf970(0x5f7,0x545,0x5d0,0x5ea)](Boolean)[_0x2bf970(0x615,0x59a,0x4d8,0x550)](',\x20'),_0x46759f={};_0x46759f['type']=_0x1e235b['xbLcw'],_0x46759f['text']=_0x4a57b1,_0x498886['push'](_0x46759f);if(_0x56f6fc){const _0x14a78={};_0x14a78[_0xe43dff(-0x6a,0xf,-0x49,0x3)]=_0x56f6fc;const _0x376e89={};_0x376e89[_0x2bf970(0x538,0x511,0x511,0x56b)]=_0x1e235b[_0x2bf970(0x5c0,0x5ea,0x49d,0x54c)],_0x376e89['image_url']=_0x14a78,_0x498886['push'](_0x376e89),addLog(_0xe43dff(-0x197,-0x32,-0x167,-0xfb)+_0xe43dff(-0x149,-0x3d,-0x11e,-0x8f)+_0x2bf970(0x5d9,0x4e0,0x5e2,0x53a));}const _0x5d30f0={};_0x5d30f0[_0xe43dff(-0xd9,-0xd6,-0xc1,-0x6)]=_0xe43dff(-0x142,-0x11a,-0xc3,-0x16c),_0x5d30f0['content']=_0x498886,_0x5bc6d5['push'](_0x5d30f0),_0x1e235b[_0xe43dff(-0x9c,-0x175,-0xfa,-0xf9)](addLog,_0xe43dff(-0x1aa,-0xc5,-0x17f,-0xfb)+_0x2bf970(0x64f,0x6bb,0x690,0x652)+_0x4a57b1);}const _0x412937={};_0x412937['aspectRati'+'o']=_0x20a1ea;const _0x313041={};_0x313041[_0xe43dff(-0x12,0xa4,0xe0,0x32)+'g']=_0x412937,_0x544b1d={'model':_0x87ed65,'messages':_0x5bc6d5[_0x2bf970(0x619,0x519,0x674,0x5ea)](_0x4c9e2b=>_0x4c9e2b[_0xe43dff(-0x124,-0xf2,-0x11c,-0xa1)][_0xe43dff(-0xfb,-0x3b,-0x14a,-0x110)]>-0x23*0xd+0x25a0*-0x1+-0x2767*-0x1),'config':_0x313041},_0x1e235b[_0xe43dff(-0x77,-0x62,-0x113,-0x6e)](addLog,_0xe43dff(-0xce,-0x1cf,-0x110,-0x10f)+'uilt\x20multi'+_0xe43dff(-0x1e1,-0x1e1,-0xe1,-0x117)+_0xe43dff(-0x152,-0xfb,-0x188,-0x121)+_0x544b1d[_0x2bf970(0x475,0x4b1,0x498,0x4d2)][_0x2bf970(0x485,0x5aa,0x579,0x534)]+'\x20messages.');}}let _0x89028f=_0x400f0f[_0x2bf970(0x5f6,0x6b2,0x592,0x5fa)](/\/$/,'');function _0xe43dff(_0x2774da,_0x3b2deb,_0x524f86,_0x1c4c6e){return _0x5357(_0x1c4c6e- -0x2c3,_0x3b2deb);}let _0x3f08f9;if(_0x89028f[_0x2bf970(0x50b,0x586,0x60d,0x590)](_0x1e235b['nfIPL'])||_0x89028f['includes'](_0x1e235b[_0xe43dff(-0x5c,0x38,0xf,-0x61)])){if(_0x1e235b[_0x2bf970(0x468,0x553,0x404,0x4cb)](_0x1e235b['lCRGS'],_0x1e235b[_0x2bf970(0x549,0x49f,0x493,0x53f)]))_0x3f08f9=_0x89028f+_0x21fcdf;else return _0x3bb782[_0x2bf970(0x6d7,0x5a6,0x5f4,0x65f)]()[_0x2bf970(0x4a4,0x4cd,0x55f,0x4dc)](WeYedy[_0xe43dff(-0x6,-0x15b,0x2b,-0xad)])[_0xe43dff(0x4e,-0x58,0x5a,0x1b)]()[_0x2bf970(0x531,0x614,0x516,0x5e0)+'r'](_0x4c0054)[_0x2bf970(0x51a,0x52f,0x4d3,0x4dc)](WeYedy[_0xe43dff(-0xe2,-0x137,-0xf,-0xad)]);}else{if(_0x1e235b['lcwJX'](_0x1e235b[_0xe43dff(0x1b,-0xfd,-0x14a,-0x77)],_0xe43dff(-0x15,-0x12b,0x10,-0x85))){const _0x463109=_0x25e94a?function(){function _0x1af58a(_0x22760d,_0x25faab,_0xb54c14,_0x145e5f){return _0x2bf970(_0x22760d-0x36,_0xb54c14,_0xb54c14-0x129,_0x25faab- -0xa5);}if(_0x38b233){const _0xa726c7=_0x109feb[_0x1af58a(0x4b0,0x444,0x510,0x453)](_0x327993,arguments);return _0x12c493=null,_0xa726c7;}}:function(){};return _0x361682=![],_0x463109;}else _0x3f08f9=_0x1e235b[_0x2bf970(0x596,0x5a5,0x4f8,0x4f3)](_0x1e235b[_0xe43dff(-0x8f,-0x74,-0x142,-0x113)](_0x89028f,_0x1e235b['nfIPL']),_0x21fcdf);}_0x3f08f9=_0x3f08f9[_0xe43dff(-0x106,-0x6f,0x2b,-0x4a)](/\/v1\/v1\//g,_0x1e235b[_0x2bf970(0x5ce,0x683,0x676,0x5e3)]);const _0xa69c98=extension_settings[extensionName][_0xe43dff(0xbc,-0xa1,-0x67,-0x3)];let _0x3220ad,_0x10f60f,_0xa7bdf5;if(_0xa69c98===_0x1e235b[_0xe43dff(-0x106,-0x197,-0x132,-0x156)]){if(_0x1e235b['AWIQi'](_0x1e235b['dsRCF'],_0x1e235b['dsRCF'])){let _0x19dc81=_0x89028f;!_0x19dc81[_0xe43dff(-0x93,-0x3b,-0x152,-0xb4)](_0x1e235b['nfIPL'])&&!_0x19dc81[_0x2bf970(0x60d,0x60b,0x5c9,0x66c)](_0x2bf970(0x58b,0x50d,0x415,0x4d5))&&(_0x1e235b[_0x2bf970(0x60e,0x656,0x712,0x677)](_0x1e235b['xcqFc'],_0x1e235b[_0x2bf970(0x66b,0x591,0x6ca,0x66b)])?_0x19dc81=_0x1e235b['OoSMN'](_0x19dc81,_0x1e235b[_0xe43dff(-0x50,-0x121,-0x1b9,-0xec)]):(_0x4ab114['on'](_0x3af49c['GENERATE_I'+_0xe43dff(-0xcb,-0xeb,-0x1ad,-0x109)+'ST'],_0x2bc7f3),_0x2b1a96['on'](_0x1e235b['zarQn'],_0x27cff1),_0x1e235b[_0xe43dff(-0xb8,0xc8,0x7f,0x4)](_0x5d04b2,_0x1e235b['AVxci'])));_0x19dc81=_0x19dc81['replace'](/\/v1\/$/,_0x1e235b[_0xe43dff(-0x85,-0x163,-0xfd,-0xec)]),_0x3220ad=_0xe43dff(0x6,-0xb4,0xdc,0x12)+'nds/chat-c'+_0xe43dff(-0x16,-0x2e,0x54,-0x1b)+_0xe43dff(-0x86,0x50,-0xcd,-0x53),_0x10f60f=_0x1e235b[_0x2bf970(0x5eb,0x569,0x5df,0x578)](getRequestHeaders,window[_0xe43dff(-0x194,-0x16e,-0x6c,-0x10c)]);const _0x44cebc={};_0x44cebc['chat_compl'+_0x2bf970(0x69a,0x63f,0x54d,0x626)+'ce']=_0x1e235b[_0xe43dff(-0x40,-0x93,0x5f,-0x9)],_0x44cebc[_0x2bf970(0x53a,0x543,0x5d9,0x559)]=_0x19dc81,_0x44cebc['custom_inc'+_0xe43dff(0x1,-0xc,-0x8b,-0x22)+'rs']=_0x2bf970(0x54c,0x5e3,0x533,0x591)+_0xe43dff(-0x14c,-0xc0,-0x97,-0x8c)+_0x2bf970(0x5e4,0x63d,0x687,0x66a)+_0x3c9895+'\x22',_0x44cebc[_0x2bf970(0x611,0x5ae,0x57d,0x609)]=_0x87ed65,_0x44cebc[_0xe43dff(-0xd6,-0x186,-0x126,-0x172)]=_0x544b1d[_0xe43dff(-0xfc,-0x177,-0xa4,-0x172)],_0x44cebc[_0x2bf970(0x460,0x488,0x437,0x504)]=![],_0xa7bdf5=_0x44cebc;if(_0x87ed65[_0xe43dff(-0xb2,-0x144,-0x171,-0x16a)](_0x1e235b['TbFsA'])){if(_0x1e235b[_0x2bf970(0x52b,0x523,0x5e1,0x52b)](_0x1e235b[_0xe43dff(-0xe2,-0x133,-0x10b,-0xd5)],_0x1e235b[_0xe43dff(-0xa7,0xa9,-0x48,0x1a)])){_0x1e235b[_0x2bf970(0x585,0x5f8,0x51e,0x5cb)](addLog,'[Banana]\x20I'+_0x2bf970(0x5f3,0x573,0x5ba,0x54a)+_0x2bf970(0x553,0x4a2,0x598,0x54f)+_0xe43dff(-0xf6,-0x193,-0x58,-0x120)),_0x3220ad=_0x3f08f9;const _0x1a9fac={};_0x1a9fac[_0x2bf970(0x44d,0x5a0,0x50c,0x517)+'pe']=_0x1e235b[_0xe43dff(-0x3b,0x30,0x25,-0x7b)],_0x1a9fac[_0x2bf970(0x543,0x57b,0x58e,0x591)+_0xe43dff(0x0,0x65,0x7a,-0x12)]='Bearer\x20'+_0x3c9895,_0x10f60f=_0x1a9fac,_0xa7bdf5=_0x544b1d;}else!_0x1956a7[_0xe43dff(-0x95,-0x18f,-0xe7,-0xd2)+'BananaList'+_0xe43dff(0x29,0x6d,-0x84,0x2d)]&&(_0x10c18f[_0xe43dff(-0xf5,-0x10d,-0x113,-0xd2)+_0xe43dff(-0x1d0,-0x233,-0x1fc,-0x170)+'ener']=!![],_0x1e235b[_0xe43dff(0xfd,0x4f,0x8,0x23)](_0x142a40)),_0x4e3f8c();}addLog('[Banana]\x20使'+'用酒馆代理模式');}else{const _0x3eb327={};_0x3eb327[_0xe43dff(-0x34,0x4e,-0x1d,-0x6)]=_0x1e235b[_0x2bf970(0x53e,0x588,0x5d2,0x56a)],_0x3eb327[_0xe43dff(0x30,-0x123,-0x115,-0xa1)]=[{'type':_0x1e235b[_0xe43dff(-0x170,-0x52,-0x11b,-0x9c)],'text':_0x4257ea}],_0x5a9ad3[_0x2bf970(0x535,0x5ef,0x60c,0x55b)](_0x3eb327);}}else{if(_0x1e235b['fPeaS'](_0x1e235b[_0x2bf970(0x67a,0x54b,0x5d1,0x5ed)],_0x1e235b[_0xe43dff(-0x170,-0x162,-0x15b,-0x104)])){_0x1e235b[_0x2bf970(0x5de,0x57f,0x5f1,0x62c)](_0x4fdafb,_0x1e235b[_0xe43dff(-0x60,0x65,-0x17,-0x5)]);const _0x19195a=_0x1e235b[_0x2bf970(0x558,0x4f1,0x587,0x565)](_0x37be7a,'默认'),_0x4fecf7={};_0x4fecf7['conversati'+'on']=[],_0x4fecf7[_0x2bf970(0x598,0x60f,0x64b,0x57a)+'t']='',_0x3e8fbf=_0x2e03fc[_0x19195a]||_0x4fecf7,_0x1e235b['WJIMG'](_0x432f26,_0x2bf970(0x492,0x4d6,0x586,0x552)+_0x2bf970(0x5a5,0x418,0x44f,0x4cd)+_0x19195a+'\x22');}else _0x3220ad=_0x3f08f9,_0x10f60f=getDirectHeaders(_0x1e235b[_0x2bf970(0x59a,0x5d9,0x523,0x5c9)],'Bearer\x20'+_0x3c9895),_0xa7bdf5=_0x544b1d,addLog(_0xe43dff(-0x189,-0x52,-0x45,-0xf2)+_0x2bf970(0x62e,0x689,0x67e,0x5e1));}_0x1e235b[_0x2bf970(0x64f,0x4f2,0x651,0x5cb)](addLog,_0x2bf970(0x4bd,0x531,0x5f4,0x58d)+_0xe43dff(0x7,-0x2c,-0x120,-0x86)+_0xe43dff(-0x1ae,-0xcd,-0xe9,-0x138)+_0x3220ad),addLog(_0xe43dff(-0x1d8,-0x1d2,-0x175,-0x137)+_0x2bf970(0x5f2,0x655,0x50e,0x59e)+JSON[_0x2bf970(0x63d,0x618,0x5c7,0x56c)](_0xa7bdf5,null,-0x99+0x9*0x3f4+-0x22f9));try{if(_0x1e235b['dqBEM']!==_0x1e235b[_0xe43dff(-0xc8,-0x19f,-0x181,-0xf3)])_0x13bd77=_0x1e235b[_0xe43dff(-0xf9,-0x1ea,-0x1c6,-0x113)](_0x5b3af2,_0x1c4720);else{taskQueue[_0xe43dff(-0x5c,-0x112,0x51,-0x71)+'us'](_0x3f8a74,'running');const _0x2b9648=await fetch(_0x3220ad,{'method':_0x1e235b['svKZf'],'headers':_0x10f60f,'body':JSON[_0xe43dff(-0x14a,-0x7e,-0x13b,-0xd8)](_0xa7bdf5)});if(!_0x2b9648['ok']){if(_0x1e235b[_0x2bf970(0x747,0x671,0x741,0x66d)](_0x1e235b[_0xe43dff(-0x6e,-0x120,-0x199,-0x12b)],_0x1e235b[_0x2bf970(0x54a,0x585,0x467,0x519)])){const _0xf25724=await _0x2b9648[_0xe43dff(-0x161,-0x19c,-0x148,-0x135)]();throw new Error('API\x20reques'+_0x2bf970(0x4e2,0x4d9,0x4e7,0x515)+_0x2bf970(0x677,0x530,0x63b,0x5ab)+'\x20'+_0x2b9648[_0xe43dff(-0xe3,-0x11c,-0x118,-0x118)]+':\x20'+_0xf25724);}else throw new _0x5aa28f(_0x2bf970(0x5d0,0x62a,0x5c0,0x615)+_0x2bf970(0x512,0x57e,0x5d7,0x518)+_0xe43dff(-0x81,-0x121,-0x80,-0xfc)+_0xe43dff(-0x7,-0xaa,-0x1d,-0xc2)+_0x2bf970(0x5b6,0x569,0x4e6,0x57f)+'t');}const _0x54926b=await _0x2b9648[_0xe43dff(0xbe,-0x2c,-0x28,0x1f)]();let _0x76252e='';const _0x2b10e3=_0x54926b[_0xe43dff(-0xd1,-0xe0,-0xc4,-0xf1)];if(_0x2b10e3&&_0x1e235b[_0xe43dff(-0x4a,-0xa5,-0x73,-0x29)](_0x2b10e3[_0x2bf970(0x5b1,0x576,0x4ab,0x534)],-0x1aea+-0xa3c+-0xa*-0x3b7)){if(_0x1e235b[_0xe43dff(-0xe2,-0x181,-0x199,-0xdb)](_0x1e235b[_0x2bf970(0x575,0x459,0x58d,0x4c6)],_0x1e235b[_0xe43dff(-0xf1,-0x1cb,-0xdf,-0x17e)])){const _0x18d3db=_0x2b10e3[0x1f65+-0x17a2+0x1*-0x7c3][_0xe43dff(-0x16c,-0x9,-0x33,-0xb5)]?.[_0x2bf970(0x5d5,0x665,0x5fb,0x5a3)];if(Array[_0xe43dff(-0xf5,-0x94,-0xd3,-0x162)](_0x18d3db))for(const _0x5bf768 of _0x18d3db){if(_0x1e235b[_0x2bf970(0x4b1,0x4b5,0x49a,0x569)](_0x1e235b[_0x2bf970(0x50d,0x659,0x5f8,0x5c1)],_0xe43dff(0xa4,-0x42,0xab,0xa)))_0x26f68b[_0x2bf970(0x644,0x60f,0x53e,0x571)+'sk'](_0x2c4839,![]);else{if(_0x1e235b['Henap'](_0x5bf768['type'],_0x1e235b['FvLKW'])&&_0x5bf768['image_url']?.[_0x2bf970(0x62f,0x601,0x578,0x647)]){_0x76252e=_0x5bf768[_0x2bf970(0x6ba,0x64e,0x5c8,0x674)][_0xe43dff(-0x63,-0x55,0x1c,0x3)];break;}}}else{if(typeof _0x18d3db===_0xe43dff(-0x14f,-0xd5,-0xfc,-0x150)){const _0x464ef3=/!\[.*?\]\(((?:https?:\/\/|data:image\/[^;]+;base64,)[^\s\)]+)\)/,_0x38e98c=_0x18d3db[_0x2bf970(0x503,0x4e7,0x619,0x598)](_0x464ef3);if(_0x38e98c&&_0x38e98c[0x2521*-0x1+0x145e+0x1d*0x94]){if(_0x1e235b[_0x2bf970(0x5fe,0x5b7,0x609,0x59d)](_0x1e235b['NldPo'],_0x1e235b[_0x2bf970(0x67c,0x5f3,0x6af,0x5e5)]))_0x566dbd[_0xe43dff(-0x77,-0x18,-0xfe,-0xe1)+_0xe43dff(0x103,0x36,-0x9a,0x2d)](_0x10b608,_0x3f3746);else{const _0x48c4c6=_0x38e98c[0x110c+-0x77d*0x1+-0x4c7*0x2];if(_0x48c4c6['startsWith'](_0x1e235b[_0x2bf970(0x481,0x3fd,0x460,0x4c7)]))_0x1e235b[_0xe43dff(-0x5c,-0x152,-0x106,-0x79)](addLog,_0x1e235b[_0xe43dff(-0xdc,-0xd4,-0x1a9,-0x173)]),_0x76252e=_0x48c4c6,addLog(_0x1e235b[_0x2bf970(0x681,0x530,0x5e9,0x5cf)]);else{addLog('[Banana]\x20D'+_0xe43dff(-0x1f3,-0x14c,-0x17c,-0x160)+_0x2bf970(0x62d,0x577,0x57a,0x640)+_0xe43dff(0x1,-0x33,0x7e,-0x35)+_0xe43dff(-0x6c,0x1e,0x1d,0x18)+'.'),_0x1e235b[_0x2bf970(0x4b2,0x4da,0x4ba,0x50b)](addLog,_0x2bf970(0x694,0x61c,0x606,0x5e7)+_0xe43dff(0x16,-0xe2,0x5d,-0x6d)+_0xe43dff(0x1,-0x7c,-0x23,0x7)+_0x48c4c6);try{if(_0x1e235b[_0x2bf970(0x5e4,0x601,0x48b,0x52b)](_0x1e235b[_0x2bf970(0x4fc,0x5b3,0x580,0x5c2)],_0x1e235b[_0xe43dff(-0x96,0x12,0x58,-0x82)])){const _0x249dde=_0x532196[_0x2bf970(0x4a2,0x5c4,0x496,0x4e9)](_0x53b558,arguments);return _0x217e6d=null,_0x249dde;}else{const _0x98147f=await _0x1e235b[_0xe43dff(-0x25,-0x6f,-0xc,-0x94)](fetch,_0x48c4c6,{'headers':_0x1e235b[_0x2bf970(0x60c,0x707,0x6bf,0x667)](getDirectHeaders)});if(!_0x98147f['ok']){if(_0x1e235b[_0xe43dff(-0x1d0,-0x1cd,-0xfd,-0x10e)](_0xe43dff(0x43,0xd,-0x60,0x2a),_0x1e235b[_0xe43dff(0x1f,0xa8,-0x28,0x11)]))throw new Error(_0x2bf970(0x6d3,0x5dc,0x620,0x669)+_0xe43dff(-0x6c,-0x171,-0x1a,-0xbd)+_0xe43dff(-0x3a,-0xc4,-0xf0,-0x72)+_0x98147f['status']);else throw new _0x17c731('Failed\x20to\x20'+_0xe43dff(-0x140,-0x100,0x1c,-0xbd)+'e:\x20'+_0x1d0a5a[_0xe43dff(-0xf9,-0x71,-0x55,-0x118)]);}const _0xe072e7=await _0x98147f['blob'](),_0x222772=await new Promise((_0x489d87,_0x1bd70f)=>{function _0x2695fa(_0x26a56c,_0x53361e,_0x3e0d3d,_0xea9bab){return _0xe43dff(_0x26a56c-0x143,_0x3e0d3d,_0x3e0d3d-0x178,_0x53361e-0x633);}function _0x5bc9bf(_0x38002c,_0x51ba19,_0x6e85ba,_0x4d230b){return _0x2bf970(_0x38002c-0x4c,_0x38002c,_0x6e85ba-0xa8,_0x51ba19- -0x30b);}if(_0x1e235b[_0x5bc9bf(0x2b8,0x22b,0x21b,0x153)](_0x5bc9bf(0x1ee,0x1c4,0x1c4,0x134),_0x1e235b['dxWbh'])){if(_0x1f81ca['initialize'+'BananaList'+_0x2695fa(0x682,0x660,0x6be,0x6e2)]){const _0x1fc8d1=_0x1e235b[_0x2695fa(0x610,0x583,0x5eb,0x628)][_0x2695fa(0x5d7,0x56f,0x4af,0x52e)]('|');let _0x2562f7=-0x9*-0x279+0x3*0x11b+-0x1992;while(!![]){switch(_0x1fc8d1[_0x2562f7++]){case'0':_0x1e235b['WJIMG'](_0x57b883,'[Banana]\x20生'+_0x2695fa(0x5fd,0x56b,0x63d,0x62a));continue;case'1':_0x13a3df['removeList'+_0x2695fa(0x6ca,0x660,0x5f6,0x5bf)]('st_chatu8_'+_0x2695fa(0x60f,0x626,0x6be,0x647)+'ana_task',_0x5de974);continue;case'2':_0x44b262[_0x2695fa(0x5a8,0x552,0x58d,0x4da)+_0x5bc9bf(0x3f3,0x366,0x39a,0x380)](_0x39bea1[_0x2695fa(0x6b3,0x60b,0x560,0x603)+_0x2695fa(0x5cc,0x52a,0x484,0x450)+'ST'],_0x2d4667);continue;case'3':_0x120b2f[_0x2695fa(0x5ff,0x5e3,0x678,0x595)](_0x31aa7c=>{function _0xe992e2(_0x207182,_0x2ed1e5,_0x4cfa4a,_0x15e37b){return _0x5bc9bf(_0x4cfa4a,_0x2ed1e5- -0x93,_0x4cfa4a-0x120,_0x15e37b-0xe7);}function _0x2346f4(_0x24bcca,_0x2a9d86,_0x221936,_0x4e1d9a){return _0x2695fa(_0x24bcca-0x5e,_0x221936- -0x167,_0x24bcca,_0x4e1d9a-0x6b);}_0x45e774[_0x2346f4(0x489,0x414,0x3eb,0x3b4)+_0xe992e2(0x1fb,0x2d3,0x25b,0x350)](_0x31aa7c,_0x320c7a);});continue;case'4':_0x2034bb[_0x2695fa(0x5c7,0x561,0x60d,0x5c5)+_0x5bc9bf(0x215,0x1c9,0x155,0x1a8)+_0x5bc9bf(0x2a2,0x366,0x3be,0x334)]=![];continue;}break;}}}else{const _0x5cffd2=new FileReader();_0x5cffd2['onloadend']=()=>_0x489d87(_0x5cffd2[_0x2695fa(0x64f,0x622,0x604,0x605)]),_0x5cffd2['onerror']=_0x1bd70f,_0x5cffd2[_0x5bc9bf(0x2da,0x206,0x1b6,0x21b)+_0x5bc9bf(0x1ef,0x2a9,0x2a9,0x354)](_0xe072e7);}});_0x76252e=_0x222772,_0x1e235b[_0x2bf970(0x5f7,0x4d8,0x5c8,0x59d)](_0x1e235b[_0x2bf970(0x56b,0x592,0x5f5,0x520)](String,extension_settings[extensionName][_0xe43dff(-0x116,-0x221,-0x168,-0x17c)+'pegStorage']),_0x1e235b['TMdTc'])&&(_0x76252e=await _0x1e235b[_0xe43dff(-0x14e,-0xc,-0x23,-0x93)](convertImageToJpeg,_0x76252e)),_0x1e235b[_0xe43dff(-0xc1,-0x5e,-0x4,-0x38)](addLog,_0x1e235b[_0x2bf970(0x695,0x596,0x66d,0x654)]);}}catch(_0x112ca5){if(_0x1e235b['zagWV'](_0x2bf970(0x48d,0x421,0x4ae,0x4de),_0xe43dff(-0x15d,-0x178,-0x105,-0x166))){const {taskId:_0x55c299}=_0x112ea8;_0x1e235b[_0x2bf970(0x6a5,0x71f,0x5dc,0x648)](_0x25ba8e,_0xe43dff(-0x3e,-0x28,-0xd,-0xaf)+_0x2bf970(0x608,0x5c7,0x5ef,0x532)+_0x2bf970(0x6e3,0x548,0x6ec,0x614)+_0x55c299+')');if(_0xd8a20b===_0x55c299&&_0x1f1157){const _0x17df5f=_0x1e235b['VGCkX']['split']('|');let _0x48d9f8=-0xb1*-0x22+0x78+-0x17fa;while(!![]){switch(_0x17df5f[_0x48d9f8++]){case'0':_0x43f9a3=null;continue;case'1':_0x33fe43=null;continue;case'2':_0x1e235b[_0x2bf970(0x548,0x59e,0x5c9,0x616)](_0x285ee6,'[Banana]\x20取'+'消当前任务，发送失败'+_0xe43dff(0xd,0x6e,0x70,-0x24)+_0x414dcf+')');continue;case'3':_0x4633e8=null;continue;case'4':const _0x5b204a={};_0x5b204a['id']=_0x3050a6,_0x5b204a[_0xe43dff(-0xda,-0x196,-0x172,-0x122)]=![],_0x5b204a[_0x2bf970(0x69d,0x5ef,0x594,0x644)]=_0x1e235b[_0xe43dff(-0x8b,-0x15,-0x195,-0xe5)],_0x5b204a[_0xe43dff(-0xa0,-0x11d,-0x4a,-0x102)]=_0x3679c2||'',_0x4e5c35['emit'](_0x5b280a[_0xe43dff(-0xcd,-0x7c,0xa2,-0x28)+_0x2bf970(0x5dd,0x626,0x643,0x638)+_0xe43dff(-0xeb,-0xad,0x3d,-0x31)],_0x5b204a);continue;}break;}}}else _0x1e235b['ykwmy'](addLog,_0x2bf970(0x558,0x62c,0x512,0x56d)+'ailed\x20to\x20f'+_0x2bf970(0x640,0x612,0x57a,0x5a9)+_0xe43dff(-0x47,-0x41,0x15,-0xa)+'\x20'+_0x112ca5['message']),_0x76252e=_0x48c4c6,_0x1e235b[_0xe43dff(-0x126,-0x12f,0x29,-0xa0)](addLog,_0xe43dff(0x82,0xa0,0x55,0x8)+'sing\x20direc'+'t\x20URL\x20as\x20f'+_0x2bf970(0x51f,0x629,0x644,0x5ee));}}}}else _0x1e235b[_0x2bf970(0x505,0x540,0x50d,0x508)](addLog,_0x1e235b[_0xe43dff(0xa0,-0xb,-0x85,0x16)]);}}}else _0x1c8209=_0x1e235b[_0x2bf970(0x59d,0x5c0,0x45c,0x531)](_0x29dd81,_0x1e235b[_0xe43dff(-0x39,-0xb3,-0x8f,-0x115)])+_0x1e235b[_0xe43dff(-0x1a2,-0x116,-0x78,-0xcc)](_0x2d9a0d,_0x446dbd['Character\x20'+_0x2b4050+_0x2bf970(0x5a7,0x502,0x4f1,0x4f8)]);}if(!_0x76252e)throw new Error(_0x1e235b['wbEZq']);return _0x1e235b[_0xe43dff(-0x2a,-0x114,-0x145,-0x6e)](addLog,_0x1e235b['pZOkY']),taskQueue[_0x2bf970(0x5c7,0x624,0x4c9,0x571)+'sk'](_0x3f8a74,!![]),currentTaskId=null,{'image':_0x76252e,'change':_0x1e235b[_0xe43dff(-0x141,-0x17,-0xa3,-0x69)](_0x1111b3,'')};}}catch(_0x5d8c3f){const _0x4a21e6=_0x1e235b['Piusn'][_0xe43dff(-0xd8,-0x2f,-0xed,-0xc4)]('|');let _0x5c31e7=-0x2250+0x1095+0x11bb;while(!![]){switch(_0x4a21e6[_0x5c31e7++]){case'0':throw _0x5d8c3f;continue;case'1':console[_0x2bf970(0x662,0x6b8,0x6a3,0x644)](_0x1e235b[_0xe43dff(-0xa2,-0xb0,-0x2,-0x1)],_0x5d8c3f);continue;case'2':if(_0x5d8c3f[_0x2bf970(0x5e1,0x57c,0x627,0x58f)]==='任务已取消'){}else taskQueue[_0xe43dff(-0xcb,-0x16c,-0xd8,-0xd3)+'sk'](_0x3f8a74,![]);continue;case'3':_0x1e235b['AfRFM'](addLog,'[Banana]\x20F'+_0x2bf970(0x6cb,0x589,0x67f,0x624)+':\x20'+_0x5d8c3f[_0xe43dff(-0x14b,-0xd7,-0x1d,-0xb5)]);continue;case'4':currentTaskId=null;continue;}break;}}}export async function bananaGenerate(_0x57da41){const _0x4ca34e={'nOsHV':function(_0x330bd8,_0xd5c908){return _0x330bd8(_0xd5c908);},'hGPNd':function(_0x45567b,_0x50ad27,_0x28dead){return _0x45567b(_0x50ad27,_0x28dead);},'PTPub':_0x559651(-0xeb,-0x89,0x1e,-0xad)+_0x268f1c(0x108,0x63,-0x27,0x18),'WNLOM':function(_0x280db1,_0x299cf3){return _0x280db1(_0x299cf3);},'rpbXN':function(_0x407f0a,_0x4f9002){return _0x407f0a+_0x4f9002;},'ECAxA':function(_0x5ba126,_0xbf0c04){return _0x5ba126+_0xbf0c04;},'CuFtq':'\x20|\x20','zVgpd':function(_0x3d9bf5,_0x20e894){return _0x3d9bf5(_0x20e894);},'dQPcp':function(_0x5c09b2){return _0x5c09b2();},'kobIW':function(_0x152229,_0x51cec8){return _0x152229(_0x51cec8);},'HTSoO':'sxfAA','vGeYl':_0x268f1c(-0x61,0x35,-0xe,-0x88),'RwQyd':function(_0x5d2ec5,_0x5b2f8f){return _0x5d2ec5(_0x5b2f8f);},'jLWOj':function(_0x526039,_0x2289ba){return _0x526039!=_0x2289ba;},'iIxmi':function(_0x13738d,_0x10ba9d){return _0x13738d===_0x10ba9d;},'tNzlr':'KgwIq','bsVBo':function(_0x27efee,_0x306248,_0x56bca1,_0x66c8c1){return _0x27efee(_0x306248,_0x56bca1,_0x66c8c1);},'TKfhE':function(_0x5705f9,_0x53a68f){return _0x5705f9(_0x53a68f);},'QicZb':function(_0x50ec53,_0x5c9464){return _0x50ec53===_0x5c9464;},'lLjNk':_0x559651(-0x17c,-0x112,-0x85,-0xd5),'hmALc':_0x268f1c(-0x28,-0xc7,-0x24,-0x58),'benFl':function(_0x341075,_0x5e827b){return _0x341075(_0x5e827b);}};_0x4ca34e['dQPcp'](clearLog);let {id:_0x29e175,prompt:_0x10eada,width:_0x4745c9,height:_0xfcd4,change:_0x290d3d,retouchPrompt:_0x5ba3f6,retouchImage:_0x1d91cc}=_0x57da41;currentRequestId=_0x29e175;function _0x559651(_0x410c6c,_0x25d839,_0x15e280,_0x53ac88){return _0x5357(_0x53ac88- -0x361,_0x410c6c);}function _0x268f1c(_0x247fb2,_0x1ea0d9,_0x42b59a,_0x2d8713){return _0x5357(_0x1ea0d9- -0x247,_0x42b59a);}currentPrompt=_0x10eada,_0x4ca34e['kobIW'](addLog,_0x559651(-0x23e,-0x117,-0xd9,-0x172)+_0x559651(-0x126,-0x191,-0x193,-0x1f8)+'age\x20genera'+_0x559651(-0x26b,-0x267,-0x206,-0x194)+'st\x20(ID:\x20'+_0x29e175+')');let _0x245771='';_0x290d3d?_0x245771=_0x290d3d[_0x559651(-0x27b,-0x28e,-0x2ae,-0x205)](_0x268f1c(-0x93,0x33,0xe8,0xf3),''):_0x245771=_0x10eada;if(_0x290d3d&&_0x290d3d[_0x268f1c(0xb3,0xa4,-0x37,0x40)](_0x559651(-0x13c,-0x12a,-0x1c,-0xe7))){addLog(_0x268f1c(-0x112,-0xa2,0x30,-0xe8)+'启动');if(_0x5ba3f6)_0x4ca34e[_0x268f1c(-0x14f,-0xbf,-0x166,-0x6f)](addLog,_0x559651(-0x28a,-0x268,-0x251,-0x1e6)+_0x5ba3f6);if(_0x1d91cc)addLog(_0x559651(-0x16b,-0x19,-0x112,-0xa5)+']');}try{if(_0x4ca34e[_0x559651(-0xb7,-0x1c2,-0xd2,-0x164)]!==_0x4ca34e['vGeYl']){const {image:_0xbb9dc0,change:_0x2fe7c0}=await _0x4ca34e[_0x559651(-0x68,-0x14d,-0x153,-0xe3)](generateBananaImage,{'prompt':_0x10eada,'width':_0x4745c9,'height':_0xfcd4,'change':_0x290d3d,'retouchPrompt':_0x5ba3f6,'retouchImage':_0x1d91cc});if(_0x4ca34e[_0x559651(-0x7c,-0x15,-0xca,-0x7a)](extension_settings[extensionName]['cache'],'0')){if(_0x4ca34e[_0x559651(-0x1c7,-0xa3,-0x12f,-0x11e)](_0x559651(-0x15c,-0x25d,-0x1cf,-0x1ba),_0x4ca34e[_0x268f1c(-0x10d,-0x71,-0x10e,-0x67)]))_0x4ca34e[_0x559651(-0x1a4,-0x46,-0x120,-0x100)](_0x470c36,_0x559651(-0xc4,-0x171,-0x1c9,-0x182)+'库');else{const _0x2cabf3={};_0x2cabf3['change']=_0x245771,await _0x4ca34e[_0x559651(-0x21f,-0x233,-0xed,-0x161)](setItemImg,_0x10eada,_0xbb9dc0,_0x2cabf3),_0x4ca34e[_0x559651(-0x1e8,-0xef,-0x176,-0x148)](addLog,_0x559651(-0x98,-0x19,0x1b,-0x9d)+'or\x20prompt:'+'\x20'+_0x10eada),extension_settings[extensionName][_0x559651(-0x161,-0x233,-0x290,-0x1e5)][_0x559651(-0x19b,-0x1d8,-0x148,-0x10d)]?(extension_settings[extensionName][_0x559651(-0x215,-0x1a8,-0x233,-0x1e5)][_0x268f1c(0x1e,0xd,-0x7a,-0xc9)]=_0x4ca34e[_0x559651(-0x28e,-0x2f0,-0x279,-0x218)](extension_settings[extensionName][_0x268f1c(-0x3c,-0xcb,0x4,-0x161)][_0x559651(-0xcd,-0x5e,-0x1e8,-0x10d)],0x1072+-0x1e75+-0x12b*-0xc),_0x4ca34e[_0x268f1c(-0x71,0x1a,-0x23,0x99)](addLog,_0x559651(-0xea,-0x81,-0x6f,-0xdc)+'r\x20prompt:\x20'+extension_settings[extensionName]['banana'][_0x268f1c(-0x89,0xd,-0x86,-0x52)])):(extension_settings[extensionName][_0x559651(-0x2a0,-0x249,-0x1d7,-0x1e5)]['cishu']=-0x1e8d+0xfba+0x1*0xed4,_0x4ca34e['WNLOM'](addLog,_0x559651(-0x162,-0xfc,-0x27,-0xdc)+_0x268f1c(-0x30,-0xa7,-0x1f,-0x153)+extension_settings[extensionName][_0x559651(-0x20c,-0x266,-0x1ad,-0x1e5)][_0x559651(-0x3a,-0x16f,-0x198,-0x10d)]));}}else _0x4ca34e[_0x268f1c(-0xc7,-0xd6,-0xae,-0x15d)](_0x4ca34e[_0x559651(-0xd3,-0x110,-0x12c,-0x73)],_0x4ca34e[_0x559651(-0xce,-0xb6,-0x12,-0x93)])?(_0x4f91fd=_0x19b7f2,_0x264b31=_0x4ca34e[_0x268f1c(-0x4d,-0xf8,-0x8e,-0x127)](_0x29f408,_0x4ca34e[_0x559651(-0x12f,-0xf4,-0x5f,-0x105)],'Bearer\x20'+_0x3b2390),_0x11e657=_0x648d24,_0x4ca34e[_0x559651(-0x56,-0x1e,-0xd7,-0xdb)](_0x49e8a8,'[Banana]\x20使'+_0x268f1c(-0x4d,0x19,0x59,-0xa6))):_0x4ca34e['benFl'](addLog,_0x268f1c(-0x51,-0x68,-0x8e,0x63)+'库');const _0x45d6e5={};_0x45d6e5['id']=_0x29e175,_0x45d6e5[_0x559651(-0x282,-0x1de,-0x242,-0x1c0)]=!![],_0x45d6e5[_0x559651(-0x55,-0x1f8,-0x89,-0x125)]=_0xbb9dc0,_0x45d6e5['prompt']=_0x10eada,_0x45d6e5[_0x268f1c(-0x63,-0x83,-0xd5,-0x93)]=_0x245771,eventSource[_0x559651(-0xe2,-0x1b0,-0x122,-0x17e)](EventType[_0x268f1c(0xb4,0x54,0xee,-0x5e)+'MAGE_RESPO'+_0x559651(-0x92,-0x113,-0x11b,-0xcf)],_0x45d6e5),addLog(_0x268f1c(0x74,0x48,-0x66,-0x8f)+_0x268f1c(-0x162,-0xc2,-0x4b,-0xcf)+'cess\x20respo'+_0x268f1c(-0x11c,-0x55,-0xce,-0x12d)+':\x20'+_0x29e175);}else _0x33c306[_0x268f1c(0x135,0x95,0x119,0x6e)+_0x5353b6+_0x559651(-0x1b3,-0x127,-0x230,-0x1ea)]&&(_0x19146e=_0x4ca34e[_0x559651(-0x219,-0x163,-0x25d,-0x218)](_0x4ca34e[_0x559651(-0x28b,-0x14c,-0x271,-0x1f2)](_0x55d27c,_0x4ca34e[_0x559651(-0x179,-0x232,-0x14d,-0x1a4)]),_0x4ca34e[_0x268f1c(-0x15,0x98,0x107,0x14)](_0x47e464,_0x1529e5[_0x559651(-0xd8,-0xb9,-0x7b,-0x85)+_0x355e84+_0x268f1c(-0x183,-0xd0,-0x15c,-0x67)])));}catch(_0x39f144){const _0x12d88d=_0x268f1c(0x1a,0x81,0x129,0x38)+_0x559651(-0x114,-0xcf,-0x57,-0x80)+_0x559651(-0xfd,-0x7d,-0x7d,-0xe0)+'\x20ID\x20'+_0x29e175+':\x20'+_0x39f144[_0x268f1c(0x52,-0x39,-0xf7,-0xca)];addLog(_0x12d88d),console[_0x268f1c(0x10a,0x7c,0xea,0x4c)](_0x12d88d);const _0x51d3bc={};_0x51d3bc['id']=_0x29e175,_0x51d3bc[_0x559651(-0x230,-0x10a,-0x12d,-0x1c0)]=![],_0x51d3bc['error']=_0x39f144['message'],_0x51d3bc[_0x268f1c(0xe,-0x86,-0xc5,-0x5f)]=_0x10eada,eventSource['emit'](EventType[_0x268f1c(0x62,0x54,-0x7d,-0x7b)+'MAGE_RESPO'+_0x559651(-0x152,-0x16f,-0x16c,-0xcf)],_0x51d3bc),_0x4ca34e[_0x268f1c(0x58,0x3f,0x8,0xcc)](addLog,'[Banana]\x20E'+'mitted\x20fai'+_0x559651(-0x205,-0x2af,-0x1e2,-0x1f7)+_0x559651(-0x16d,-0x12b,-0x1b7,-0x16f)+':\x20'+_0x29e175);}}function handleCancelBananaTask(_0x25bd8b){function _0x19a9d5(_0x5b2eac,_0x23eb50,_0x4d4305,_0x1b4f23){return _0x5357(_0x4d4305- -0x1e4,_0x23eb50);}const _0x439e34={'VrbbU':'前置前','FDzCN':_0x19a9d5(0xdd,0xf8,0x9c,0x81),'foGUL':_0x329ec2(-0xca,-0x79,-0xd9,0x1e),'aKEZh':_0x19a9d5(-0x4,0x48,0x2,0xa9),'gkjOt':'最后置','RhxxD':function(_0x47f6a0,_0x3707b9){return _0x47f6a0(_0x3707b9);},'hsOdH':function(_0x29eb53,_0xce3f9f){return _0x29eb53(_0xce3f9f);},'EAxCU':_0x19a9d5(0xba,-0x7a,-0xb,-0xa8),'kucry':_0x329ec2(0xd0,0x2,0x31,-0x3a),'oZDEs':function(_0xd3fc1e,_0x146db8){return _0xd3fc1e||_0x146db8;}},{taskId:_0x333c45}=_0x25bd8b;_0x439e34[_0x19a9d5(0xab,0xe5,0xa9,-0x16)](addLog,_0x19a9d5(-0x5c,0x62,0x30,-0x70)+'到取消任务事件\x20(T'+_0x19a9d5(-0x18,0x7,0xaf,0x8f)+_0x333c45+')');function _0x329ec2(_0x393d79,_0x5dc133,_0x5d76f8,_0x7277aa){return _0x5357(_0x5dc133- -0x202,_0x393d79);}if(currentTaskId===_0x333c45&&currentRequestId){if(_0x329ec2(-0x99,-0x8,-0x82,0x81)===_0x439e34[_0x19a9d5(-0x58,-0xe,-0x46,0x1e)]){_0x30de22=_0x329ec2(0x63,0xe2,0x28,0x184)+'dels/'+_0x41d393;const _0x44a75d={};_0x44a75d['fixedPromp'+'t']='';const _0x3d05dc=_0x272689[_0x376e61]||_0x44a75d,_0x356ca4=[_0x3d05dc[_0x329ec2(-0x34,-0x9,-0xd1,-0x91)+'t'],_0x3e4f2f[_0x439e34[_0x19a9d5(0xc5,0x163,0xc5,-0x10)]],_0x18b091[_0x439e34[_0x329ec2(0x3d,-0x22,-0x9d,-0x2e)]],_0x7a59f6,_0x5de0a0[_0x439e34[_0x329ec2(-0xe3,-0x5c,0x7b,-0x63)]],_0x357916[_0x439e34['aKEZh']],_0x3d05dc[_0x329ec2(-0x7,-0x5e,-0x1,-0x6d)+_0x329ec2(0x11a,0x44,0x4d,0x9)],_0x58885a[_0x439e34[_0x19a9d5(-0x4b,-0x1a,0x3a,0xce)]]]['filter'](_0x23b2a5)['join'](',\x20');_0x439e34[_0x19a9d5(-0x4,0x123,0x69,0x68)](_0x5635a6,_0x19a9d5(-0x25,-0x8,0x3c,0xc9)+_0x356ca4);const _0x5be44b={};_0x5be44b['prompt']=_0x356ca4;const _0x34f37a={};_0x34f37a['sampleCoun'+'t']=0x1,_0x34f37a[_0x19a9d5(-0x142,-0x45,-0x82,-0x125)+'o']=_0x20812f;const _0x2b5f4e={};_0x2b5f4e[_0x329ec2(-0xaa,-0x96,-0x11a,-0x148)]=[_0x5be44b],_0x2b5f4e[_0x329ec2(0xab,0x76,0x6b,-0x24)]=_0x34f37a,_0x49d2fc=_0x2b5f4e,_0x439e34['RhxxD'](_0x184a57,_0x329ec2(0x81,-0x4e,-0x4e,-0x63)+_0x19a9d5(-0x4c,0xc4,0x61,-0x75)+_0x329ec2(-0x72,0x1d,0x5c,-0xf)+_0x329ec2(0x57,0x16,0x99,0xa9)+'t:\x20'+_0x356ca4);}else _0x439e34[_0x329ec2(0x121,0x4b,0xb9,-0x14)](addLog,'[Banana]\x20取'+_0x19a9d5(0x166,0x108,0xb3,0x8c)+_0x329ec2(0x91,0x9d,0x66,0x15e)+currentRequestId+')'),eventSource[_0x329ec2(-0x6a,-0x1f,-0x21,-0xcf)](EventType[_0x329ec2(0x10c,0x99,0x31,0xd6)+_0x329ec2(0x18a,0xb5,-0x3,0x88)+_0x329ec2(0x15e,0x90,0x10e,0x18)],{'id':currentRequestId,'success':![],'error':_0x439e34[_0x19a9d5(-0x59,0xed,0x48,0xdc)],'prompt':_0x439e34[_0x329ec2(-0x26,-0x4c,0x5e,-0x23)](currentPrompt,'')}),currentTaskId=null,currentRequestId=null,currentPrompt=null;}}function initializeBananaListener(){const _0x5c6f21={};function _0x10c66a(_0x3bfdef,_0x24317e,_0x199950,_0x17f7f8){return _0x5357(_0x199950- -0x2d5,_0x24317e);}_0x5c6f21[_0x6dbdce(0x258,0x32d,0x30b,0x2b7)]=_0x6dbdce(0x260,0x1c3,0x306,0x31b)+'件监听器已初始化。';const _0x20cf85=_0x5c6f21;function _0x6dbdce(_0x841596,_0x12383d,_0x4f5835,_0x4863cf){return _0x5357(_0x841596-0x6b,_0x4f5835);}eventSource['on'](EventType[_0x6dbdce(0x306,0x39d,0x27c,0x3aa)+_0x6dbdce(0x225,0x16a,0x2bc,0x19d)+'ST'],bananaGenerate),eventSource['on'](_0x6dbdce(0x2d3,0x33c,0x28f,0x2be)+_0x10c66a(0x90,-0xcb,-0x1f,-0x73)+'ana_task',handleCancelBananaTask),addLog(_0x20cf85[_0x10c66a(-0x13e,-0x197,-0xe8,-0x198)]);}export async function replaceWithBanana(){function _0x30f7ea(_0x250c48,_0x2d2011,_0xf3eefd,_0x1d23fb){return _0x5357(_0x2d2011- -0x13e,_0x250c48);}function _0x526f8b(_0x30b509,_0x207dc4,_0x2dd62f,_0x7d02bb){return _0x5357(_0x207dc4- -0x1d8,_0x2dd62f);}const _0x258d7b={'hyUAy':function(_0x5ec4ae,_0x4e84b9){return _0x5ec4ae+_0x4e84b9;},'KFlxi':_0x30f7ea(0xf0,0x194,0x175,0x22d),'tvNqY':'CqXBs','JpJvF':function(_0x11ba37,_0x1404a6){return _0x11ba37(_0x1404a6);},'iSoLU':function(_0x22b9b8,_0x43284a){return _0x22b9b8==_0x43284a;},'uJbfQ':function(_0x5cbbb1){return _0x5cbbb1();},'JZMEh':function(_0x2c94e6){return _0x2c94e6();},'BzQyq':'OSpyd','qNNpm':'st_chatu8_'+_0x30f7ea(0x1b2,0x178,0x20b,0xe8)+_0x30f7ea(0x1f2,0x136,0x14f,0x125),'EgjnR':function(_0x29c857,_0x526c16){return _0x29c857(_0x526c16);},'fOoGk':_0x526f8b(0x56,0x99,0x13e,0xb4)+_0x30f7ea(0x44,0xbd,0xf1,0xc7)};_0x258d7b[_0x30f7ea(0xdd,0x145,0xe7,0xd9)](extension_settings[extensionName][_0x30f7ea(0x13,0x5,0x7c,0x1a)],_0x526f8b(-0x138,-0x5c,-0xd8,-0x58))?(!window[_0x30f7ea(0x7c,0xb3,0x4f,0x15)+'BananaList'+'ener']&&(window[_0x526f8b(-0x3f,0x19,0xe4,0x93)+'BananaList'+_0x30f7ea(0x25d,0x1b2,0xec,0x27b)]=!![],_0x258d7b['uJbfQ'](initializeBananaListener)),_0x258d7b[_0x30f7ea(0x147,0x7a,0x1,0x130)](initializeImageProcessing)):window[_0x30f7ea(0x35,0xb3,0xae,0xf2)+_0x30f7ea(0x16,0x15,-0xb3,0x37)+_0x526f8b(0xa5,0x118,0x167,0xdc)]&&(_0x258d7b[_0x30f7ea(-0x2a,0x97,0x108,0x61)]===_0x258d7b['BzQyq']?(eventSource[_0x30f7ea(0x81,0xa4,0x9e,0x47)+'ener'](EventType[_0x30f7ea(0x16a,0x15d,0x188,0x161)+_0x526f8b(0x75,-0x1e,-0x94,-0xad)+'ST'],bananaGenerate),eventSource[_0x526f8b(0xbd,0xa,0xc0,-0x88)+'ener'](_0x258d7b[_0x30f7ea(0x1b6,0x1b4,0x28f,0xdb)],handleCancelBananaTask),LEGACY_EVENT_NAMES[_0x30f7ea(0xbb,0x135,0x16f,0x11f)](_0x33d663=>{const _0x90b389={'oAkck':function(_0x5aaf36,_0x5181fb){function _0x1028ed(_0x5488b3,_0x1488b2,_0x39bbc7,_0x3baa8c){return _0x5357(_0x3baa8c-0x33f,_0x5488b3);}return _0x258d7b[_0x1028ed(0x575,0x678,0x5c0,0x5b1)](_0x5aaf36,_0x5181fb);},'nFffC':function(_0x5e8f4b,_0x22430e){return _0x5e8f4b+_0x22430e;},'uNzOG':_0x258d7b['KFlxi']};function _0x7e4b1c(_0x81316b,_0x326015,_0x504f1a,_0xf4629c){return _0x30f7ea(_0x326015,_0x504f1a- -0xac,_0x504f1a-0x53,_0xf4629c-0x1c5);}function _0x4273a9(_0x2835ff,_0x413cc4,_0x13b873,_0x153171){return _0x526f8b(_0x2835ff-0x1ac,_0x13b873- -0x1a4,_0x2835ff,_0x153171-0x1e4);}_0x258d7b['tvNqY']===_0x258d7b[_0x4273a9(-0xe5,0x33,-0x8b,0x15)]?eventSource[_0x4273a9(-0x16f,-0x118,-0x19a,-0xd2)+'ener'](_0x33d663,bananaGenerate):_0x4a4b13=_0x90b389[_0x7e4b1c(-0xeb,-0x112,-0x69,-0x11)](_0x90b389[_0x7e4b1c(0x7,-0x13b,-0x8c,-0x139)](_0x3b0a81,_0x90b389['uNzOG']),_0x158cfe);}),window[_0x30f7ea(0x5e,0xb3,-0x17,-0x19)+_0x30f7ea(-0x10,0x15,0x7a,0xc6)+_0x526f8b(0x81,0x118,0xa4,0x1b6)]=![],_0x258d7b[_0x526f8b(0x51,-0x86,-0x10,-0x70)](addLog,_0x258d7b[_0x30f7ea(0xc3,0x115,0x144,0x3a)])):(_0x258d7b[_0x526f8b(0x8a,0x10b,0xcd,0x32)](_0x4b8d88,_0x30f7ea(0x78,0xae,0x11f,-0x15)+_0x526f8b(0x1e,0xd6,0xc5,0xb9)+'etch\x20Markd'+_0x526f8b(0x1bb,0xe1,0x19a,0x8d)+'\x20'+_0x425637[_0x526f8b(0x3d,0x36,0x51,-0x94)]),_0x1b0f1e=_0x46ad8d,_0x258d7b['JpJvF'](_0x133f93,_0x526f8b(0xdd,0xf3,0x101,0x132)+_0x30f7ea(0x14f,0x125,0x9a,0x6b)+_0x526f8b(0x3f,0xe9,0x88,0x10b)+_0x526f8b(0x4b,0x95,0x69,0xaa))));}