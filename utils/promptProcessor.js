(function(_0xde6ab9,_0x548fd6){function _0x53ce22(_0x27460b,_0x2254f7,_0x349284,_0x3facdb){return _0x237b(_0x3facdb-0x3b,_0x27460b);}const _0x13fb83=_0xde6ab9();function _0x4ecb1c(_0x50c0fd,_0x2af8bb,_0x1cc108,_0x211f06){return _0x237b(_0x2af8bb- -0x27c,_0x1cc108);}while(!![]){try{const _0x5d7659=-parseInt(_0x4ecb1c(-0x18c,-0x191,-0x1ad,-0x1db))/(0x1b3b+0x5a3*-0x5+0xf5)*(-parseInt(_0x4ecb1c(-0x17d,-0x196,-0x1df,-0x193))/(-0x11d4+0x5*0x2c5+0x3fd))+-parseInt(_0x4ecb1c(-0x109,-0x152,-0x154,-0x189))/(0x2*-0xc27+0x373*0x6+0x39f)+-parseInt(_0x4ecb1c(-0x15b,-0x189,-0x150,-0x1ca))/(0xb04+0x62a+-0x112a)+parseInt(_0x4ecb1c(-0x1a9,-0x1b8,-0x17d,-0x1dd))/(-0x1545+-0x2*-0xd9f+-0x5f4)*(-parseInt(_0x4ecb1c(-0x182,-0x171,-0x16e,-0x164))/(0x1df2+0x1*0x21d+-0x2009*0x1))+-parseInt(_0x4ecb1c(-0x16a,-0x12a,-0x10b,-0x110))/(0x105b+-0x1*0x1e1b+0x1*0xdc7)+-parseInt(_0x53ce22(0x1c4,0x128,0x1ae,0x17a))/(0x1051*-0x1+0x107*-0x6+0x1683)*(parseInt(_0x4ecb1c(-0x166,-0x167,-0x152,-0x1b9))/(0xeb7*-0x1+-0x4f8+0x9dc*0x2))+parseInt(_0x4ecb1c(-0x186,-0x176,-0x155,-0x1ca))/(0x799+0x9ec+-0x19*0xb3)*(parseInt(_0x53ce22(0x99,0xfa,0x12d,0xee))/(-0x149*-0x1+-0x1*0x75d+0x61f*0x1));if(_0x5d7659===_0x548fd6)break;else _0x13fb83['push'](_0x13fb83['shift']());}catch(_0x472d01){_0x13fb83['push'](_0x13fb83['shift']());}}}(_0x5bbe,-0xe*0x2b75+0xc9275+0x2*-0x909d));const _0x4c74c0=(function(){const _0x478ec={};function _0x34e464(_0x322927,_0x27d034,_0x1b4a34,_0x270df6){return _0x237b(_0x27d034-0x7b,_0x1b4a34);}_0x478ec[_0x34e464(0x172,0x131,0x125,0xe1)]=function(_0x4c5388,_0x5a76e3){return _0x4c5388!==_0x5a76e3;};function _0x5a7652(_0x1cddc7,_0x4e9cf9,_0x2248e3,_0x5993e7){return _0x237b(_0x2248e3-0x27e,_0x5993e7);}_0x478ec[_0x34e464(0x158,0x172,0x129,0x191)]=_0x5a7652(0x333,0x36b,0x355,0x35a);const _0xcda87d=_0x478ec;let _0x156f36=!![];return function(_0x123174,_0x4ce600){const _0x27971c={'vNSLA':function(_0x5a29b5,_0x2fe8f5){function _0x54afed(_0x1bf419,_0x39815b,_0x252495,_0x7ea2bd){return _0x237b(_0x1bf419-0x368,_0x39815b);}return _0xcda87d[_0x54afed(0x41e,0x41e,0x410,0x453)](_0x5a29b5,_0x2fe8f5);},'TSkuO':_0xcda87d['iEELK'],'Papjc':function(_0x3728fb,_0x3fb1e3){return _0x3728fb===_0x3fb1e3;},'ffthu':_0x5aef38(0x535,0x4fb,0x4e7,0x499),'JFQaE':'iNaHP'},_0x192a10=_0x156f36?function(){function _0x21a81e(_0xb7eefc,_0x56544b,_0x125ef6,_0x2b44c8){return _0x5aef38(_0x125ef6,_0x56544b-0x17c,_0xb7eefc- -0xb8,_0x2b44c8-0x83);}function _0x5d6fab(_0x5999e2,_0x161ea5,_0x178c88,_0x58b03e){return _0x5aef38(_0x5999e2,_0x161ea5-0x15b,_0x161ea5- -0x28a,_0x58b03e-0x13a);}if(_0x27971c[_0x5d6fab(0x2a8,0x2b5,0x2cc,0x29d)](_0x21a81e(0x41c,0x41c,0x449,0x425),_0x27971c[_0x21a81e(0x485,0x4b1,0x46a,0x489)])){if(_0x4ce600){if(_0x27971c[_0x21a81e(0x45f,0x441,0x413,0x492)](_0x27971c['ffthu'],_0x27971c[_0x21a81e(0x40e,0x423,0x434,0x3c1)]))_0x51201a[_0x5d6fab(0x274,0x231,0x201,0x237)](_0x5d6fab(0x254,0x236,0x270,0x289)+_0x19da23+'@}');else{const _0x2f21a7=_0x4ce600['apply'](_0x123174,arguments);return _0x4ce600=null,_0x2f21a7;}}}else{const _0x1c11b1=_0x2f0ad2[_0x5d6fab(0x268,0x25f,0x264,0x238)](_0xef9227,arguments);return _0x28735a=null,_0x1c11b1;}}:function(){};function _0x5aef38(_0x1ba29b,_0x3c3cc9,_0x2d8932,_0x4254cb){return _0x34e464(_0x1ba29b-0x19d,_0x2d8932-0x36a,_0x1ba29b,_0x4254cb-0x82);}return _0x156f36=![],_0x192a10;};}()),_0x5e7ede=_0x4c74c0(this,function(){function _0x3d3c26(_0xe872e1,_0x43f997,_0x574501,_0x57af7e){return _0x237b(_0x43f997- -0x354,_0x574501);}const _0x105c30={};function _0x4e7a2c(_0x3eb021,_0x1142ad,_0x17dddb,_0x3641f2){return _0x237b(_0x1142ad-0x1ea,_0x3641f2);}_0x105c30[_0x3d3c26(-0x252,-0x25a,-0x210,-0x290)]=_0x4e7a2c(0x349,0x325,0x311,0x2ed)+'+$';const _0x4c328d=_0x105c30;return _0x5e7ede['toString']()['search'](_0x4c328d[_0x4e7a2c(0x32b,0x2e4,0x316,0x30c)])[_0x4e7a2c(0x356,0x312,0x317,0x318)]()[_0x4e7a2c(0x322,0x2f1,0x2fe,0x30d)+'r'](_0x5e7ede)[_0x3d3c26(-0x2a6,-0x25f,-0x2ad,-0x2b1)](_0x4c328d[_0x4e7a2c(0x321,0x2e4,0x316,0x335)]);});function _0x5bbe(){const _0x1d646c=['BMfTzte','vuj1tLK','DgvZDf9JB250zq','sKzryuu','E3VPGjRNLkJMNi3OO4xLKk/NLkJLIjFOOAG','y29UDgv4Df9WCG','BwvZC2fNzxm','y2HHDe1LDgfKyq','nJGXnZq4uLLwsfDe','vKrqyuq','CMvXDwvZDfr5Ca','CMLHyMXLCW','ANzyC0u','mxjJuNrKua','C3rYAw5NAwz5','y29UDgv4DerHDa','DxDNAMS','u0Hcv0y','BhvVr2q','se5xv28','BfLWsNm','mZy5ndu2ofLuz2nMBq','rgDdAwu','C2vHCMnO','zKjsqxu','AuvfteS','z0jOsuO','DMLSwNy','uLHLwve','C3vTuvK','v3r1tem','teniDu0','B2zPBgu','ufjRC00','u1PYuKK','r1Lfuwq','wKjZCei','DhjPz2DLCLDVCG','yxbWBhK','uwrwqwu','mtbzDLHLEwK','y29UC3rYDwn0BW','u1vXywy','zMX5DwS','zwLID2O','otGYmZC0y0LswMv4','DKfIt2i','A2v5CW','DhjPz2DLCK1Vza','BgvUz3rO','E3T1C2vYFx0','DxnLCG','zw5HyMXLza','Df90ExbLx2nVBG','DMfYAwfIBgvZ','ndC2mdCWm2f0qxjZBq','AxrxB0K','Bg1YBg8','zeTcB3C','E0bNzxr2yxi6oG','CM9Szq','vLvdwKC','yM5IwuG','DffotfK','CvL2rgG','DfbeyKy','uMzkqva','svLrAhm','thbOA1G','wMLrz1C','qxPxrMC','E3VOP5lOIBlLKk/NLkJLIjFOOAH9Fq','BNz4DM8','DgTwswG','Dg9tDhjPBMC','CvzQCxK','mJy2odG1nfztqu9tCW','phvZzxi+','CNfVDxG','z1LczLC','DfPWwgG','C3rYAw5N','q0TrDKy','q2rpwvu','ugfWAMm','Cxbvteu','E3VNLkJMIlFPNidMSyj9Fq','E0bZzxrNBg9Iyq','rwLHzhi','BKnxr1C','CMvWBgfJzufSBa','EKDNrLG','AM9PBG','kcGOlISPkYKRkq','ve1yDwm','E3VKUiRKUiVMLOD9Fq','yxnZAxn0yw50','mtzAzhPhzfK','rM5lu2i','zMfVrMi','ExvbEu4','wKjZsLq','EhrFChjVzMLSzq','rLPRsuW','A2vjDeG','DMPtqxC','q3fmqvq','B3jJv0G','wuPtzhG','y0TvCfm','B2jQzwn0','CMvWBgfJzq','qvPqCKS','C3bSAxq','zKLszKC','v25UvxC','ode3mda1n0vYzgnezG','Egrwt3G','ANPozwq','Bwf0y2HbBgW','z25KAgu','BeLWyMO','vfnRDu8','A0rfDMq','DK5ttee','rKrfrvy','y29UDgvUDa','ndKWmdG2nJnzCMrYDwG','E3TNzxr2yxi6oG','tNvfrMW','vNn3tLK','r2rrEhq','v1DVAwS','E3VPGjRNLkJOP5lOIBlLKk/NLkJLIjFOOAG','AMX0vKi','DMfYoJO','zMLSDgvY','rMvyDNe','rNf3tLe','DMzRCgm','vgrzs2m','E0bNzxr3B3jSza','AgLZDg9YEq','ueH1tgC','nwrrBeDjqW','zMLNCW','AxnbCNjHEq','z3nsqKG','zw50CMLLCW','A1nksM0','CLLlvuO','CMjjA2e','BgXTx3jLCxvLCW','vNjVuLu','BwfW','z0Dpwhi','Dg9pD3m','uK50swe','E0bNzxrNBg9Iyq','Aw5JBhvKzxm','s2vdDMW','rMH2CMu','ywrK','CNL6DLO','BhzHCJO6','Dgv4Da','DhLWzq','E0bZzxr2yxi6oG','DhjPBq','ChvZAa'];_0x5bbe=function(){return _0x1d646c;};return _0x5bbe();}_0x5e7ede();import{extension_settings}from'../../../../extensions.js';import{extensionName}from'./config.js';import{getContext}from'../../../../st-context.js';import{getglobalvar,setglobalvar}from'./chatDataUtils.js';import{getworldvar}from'./worldbookProcessor.js';export function checkTriggerWords(_0x5c9e52,_0x80dc26){const _0x1d550c={};_0x1d550c[_0x4d44db(0xaf,0xf8,0x109,0xd5)]=function(_0x3f2566,_0x14960e){return _0x3f2566||_0x14960e;},_0x1d550c[_0x4d44db(0xc0,0xf5,0x134,0xe5)]=function(_0x2d06d0,_0x2995ac){return _0x2d06d0!==_0x2995ac;},_0x1d550c['AzWFg']=_0x4d44db(0x8a,0x74,0x3f,0x2b),_0x1d550c['VUCZG']=function(_0x2a5f43,_0x31576d){return _0x2a5f43===_0x31576d;},_0x1d550c[_0x49cc86(-0x222,-0x262,-0x292,-0x262)]=_0x49cc86(-0x273,-0x25f,-0x261,-0x2ad),_0x1d550c[_0x49cc86(-0x2bf,-0x29a,-0x2aa,-0x291)]=function(_0x28dacc,_0x488e7b){return _0x28dacc===_0x488e7b;};function _0x4d44db(_0x5a642f,_0x52d141,_0x1e83a1,_0x58270d){return _0x237b(_0x52d141- -0x56,_0x58270d);}_0x1d550c[_0x4d44db(0xd5,0xaf,0x80,0x87)]='UaFUu';const _0x4f7762=_0x1d550c;function _0x49cc86(_0x111660,_0x158675,_0x5a8b6a,_0xea48dc){return _0x237b(_0xea48dc- -0x35e,_0x5a8b6a);}if(_0x4f7762[_0x49cc86(-0x226,-0x264,-0x22a,-0x210)](!_0x5c9e52,!_0x80dc26))return _0x4f7762[_0x49cc86(-0x200,-0x23c,-0x232,-0x213)](_0x49cc86(-0x277,-0x26e,-0x248,-0x294),_0x4f7762[_0x49cc86(-0x25d,-0x24c,-0x281,-0x23a)])?![]:![];const _0x58bf18=_0x5c9e52[_0x4d44db(0xad,0xf9,0xcb,0xb5)](',')[_0x4d44db(0x2f,0x78,0x78,0xb2)](_0x296478=>_0x296478[_0x49cc86(-0x2a9,-0x291,-0x2bf,-0x282)]())[_0x4d44db(0x14,0x66,0x38,0x64)](_0x44b8ee=>_0x44b8ee);if(_0x4f7762[_0x49cc86(-0x28a,-0x201,-0x258,-0x243)](_0x58bf18[_0x49cc86(-0x24d,-0x272,-0x24b,-0x24f)],-0x128c+0x19f3+-0x767)){if(_0x4f7762[_0x49cc86(-0x24e,-0x228,-0x2b7,-0x262)]===_0x4f7762[_0x4d44db(0xf4,0xa6,0x9f,0x6c)])return![];else _0x169d5b&&_0x458520[_0x49cc86(-0x2d8,-0x299,-0x2a6,-0x288)](_0xba89a0);}for(const _0x39efbe of _0x58bf18){if(_0x4f7762[_0x49cc86(-0x2ce,-0x25b,-0x2a0,-0x291)](_0x4f7762['QdVAe'],_0x49cc86(-0x289,-0x27d,-0x28a,-0x289)))return!![];else{if(_0x80dc26[_0x4d44db(0xae,0x7d,0x92,0x72)](_0x39efbe))return!![];}}return![];}export function mergeAdjacentMessages(_0x404e7c){const _0x4e7c3a={'VapZv':function(_0x780467,_0x1703c4){return _0x780467===_0x1703c4;},'tkVIh':function(_0xf06919,_0x4d723f,_0x382bbe){return _0xf06919(_0x4d723f,_0x382bbe);},'quYrK':_0x4c5722(-0xe0,-0x95,-0xe4,-0x91),'MgPlX':_0x2abcd2(0x1cc,0x1b4,0x170,0x17e)};if(!_0x404e7c||_0x4e7c3a['VapZv'](_0x404e7c['length'],-0xf4*0x17+0xee+0x14fe))return[];const _0x12c122=[];function _0x4c5722(_0xec07c3,_0x2298c4,_0x2d6f7d,_0x464fcf){return _0x237b(_0x2d6f7d- -0x1d5,_0xec07c3);}let _0x12d297=null;function _0x2abcd2(_0x55d7c8,_0x2274f7,_0x2b1d38,_0x38d46e){return _0x237b(_0x2274f7-0xc2,_0x2b1d38);}for(const _0x575026 of _0x404e7c){if(!_0x12d297){const _0x786fe8={..._0x575026};_0x12d297=_0x786fe8;}else{if(_0x12d297['role']===_0x575026['role'])_0x12d297['content']=_0x4e7c3a[_0x4c5722(-0x8a,-0xdd,-0xae,-0xf9)](mergeContent,_0x12d297[_0x2abcd2(0x151,0x174,0x166,0x1bf)],_0x575026[_0x4c5722(-0xfc,-0x13a,-0x123,-0xe3)]);else{if(_0x4e7c3a['quYrK']===_0x4e7c3a['MgPlX']){const _0x447d41={..._0x4941b5};_0x4cf700=_0x447d41;}else{_0x12c122[_0x2abcd2(0x1f2,0x19f,0x185,0x1a0)](_0x12d297);const _0x4d03d3={..._0x575026};_0x12d297=_0x4d03d3;}}}}return _0x12d297&&_0x12c122[_0x4c5722(-0xf3,-0x129,-0xf8,-0xdf)](_0x12d297),_0x12c122;}function mergeContent(_0x5e07fa,_0x299f4f){function _0x4d6678(_0x23b084,_0x28efed,_0x3685c5,_0x5059a5){return _0x237b(_0x5059a5-0x196,_0x28efed);}const _0x464f6a={'xdVOx':function(_0x12f423,_0x1f334a){return _0x12f423===_0x1f334a;},'kSJJm':_0x4d6678(0x274,0x2ec,0x2e5,0x2c5),'kDEvd':function(_0x49a6f4,_0x5c8fd4){return _0x49a6f4+_0x5c8fd4;},'jrIVf':function(_0x1623a1,_0xbfdf47){return _0x1623a1+_0xbfdf47;},'XnPhg':function(_0x327230,_0xee3bfa){return _0x327230(_0xee3bfa);},'fWfky':_0x4d6678(0x27a,0x21d,0x270,0x26f)};if(_0x464f6a[_0x4d6678(0x2b5,0x2bc,0x305,0x2e9)](typeof _0x5e07fa,_0x464f6a[_0x4d6678(0x244,0x217,0x221,0x25f)])&&_0x464f6a[_0x4d6678(0x2b8,0x330,0x33d,0x2e9)](typeof _0x299f4f,_0x464f6a[_0x4d6678(0x273,0x289,0x27e,0x25f)]))return _0x464f6a[_0x4d6678(0x332,0x2a5,0x2fb,0x2ef)](_0x464f6a['jrIVf'](_0x5e07fa,'\x0a'),_0x299f4f);function _0x272126(_0x109aba,_0x5658a6,_0x414b2b,_0x56f9c7){return _0x237b(_0x414b2b-0x369,_0x5658a6);}const _0x490b8c=normalizeToArray(_0x5e07fa),_0x57c0a1=_0x464f6a['XnPhg'](normalizeToArray,_0x299f4f),_0x2a3047={};return _0x2a3047[_0x272126(0x421,0x403,0x443,0x421)]=_0x464f6a['fWfky'],_0x2a3047[_0x4d6678(0x2bc,0x26f,0x29b,0x26f)]='\x0a',[..._0x490b8c,_0x2a3047,..._0x57c0a1];}function normalizeToArray(_0x421148){function _0x2d4845(_0x53bccc,_0x29d3ca,_0x568a7,_0x132d81){return _0x237b(_0x132d81-0x394,_0x53bccc);}const _0x42445c={};_0x42445c['CqLAT']=_0x2d4845(0x451,0x43e,0x4b3,0x46d);function _0x5e4471(_0x163f8f,_0x8e386b,_0x29558a,_0x4eca06){return _0x237b(_0x163f8f-0x188,_0x29558a);}_0x42445c['EDNQJ']=function(_0x43619d,_0x232230){return _0x43619d||_0x232230;};const _0x3db526=_0x42445c;if(Array[_0x2d4845(0x41a,0x42e,0x4a4,0x45a)](_0x421148))return _0x421148;return[{'type':_0x3db526[_0x5e4471(0x2d0,0x2e3,0x311,0x322)],'text':_0x3db526['EDNQJ'](_0x421148,'')}];}export function replacePlaceholder(_0x36d889,_0x328d8c,_0x319386,_0x40ed7c){const _0x3211da={'TdYKc':function(_0x3ff720,_0x271dff,_0x421594){return _0x3ff720(_0x271dff,_0x421594);},'IKTZq':function(_0x3c9dd2,_0x3d465c){return _0x3c9dd2===_0x3d465c;},'ZBsJT':_0x4aab86(-0x19c,-0x15a,-0x1e5,-0x169),'lmrlo':_0x2256e9(0x42d,0x475,0x406,0x3ea),'GYEQd':function(_0x53bb57,_0x217285){return _0x53bb57||_0x217285;},'LphkX':_0x4aab86(-0x213,-0x218,-0x205,-0x255),'VZHpT':function(_0x696d38,_0x10e19a){return _0x696d38===_0x10e19a;},'JvnEc':_0x4aab86(-0x17f,-0x12b,-0x14b,-0x19c),'qpULE':function(_0x41a9c5,_0x2f72ed,_0xc67975,_0x4aab15,_0x56fd16){return _0x41a9c5(_0x2f72ed,_0xc67975,_0x4aab15,_0x56fd16);}};if(_0x3211da['IKTZq'](typeof _0x36d889,_0x3211da[_0x4aab86(-0x188,-0x154,-0x15d,-0x145)])){if(_0x3211da['IKTZq'](_0x2256e9(0x441,0x48d,0x443,0x40b),_0x3211da[_0x2256e9(0x416,0x3ec,0x3f4,0x465)]))_0x56410a['push'](_0x8f4cda);else return _0x319386&&_0x36d889['includes'](_0x328d8c)&&(_0x40ed7c&&_0x40ed7c[_0x2256e9(0x3d5,0x38c,0x3be,0x3f0)](_0x328d8c)),_0x36d889[_0x2256e9(0x437,0x3fc,0x3f7,0x3fc)](_0x328d8c,_0x3211da[_0x2256e9(0x400,0x40d,0x3dc,0x3cd)](_0x319386,''));}if(Array[_0x2256e9(0x3c5,0x3bb,0x409,0x399)](_0x36d889)){if(_0x3211da['IKTZq'](_0x3211da[_0x4aab86(-0x1a9,-0x1b6,-0x1b9,-0x1b3)],_0x3211da['LphkX']))return _0x36d889[_0x4aab86(-0x1fd,-0x1ce,-0x1d1,-0x204)](_0xd28f47=>replacePlaceholder(_0xd28f47,_0x328d8c,_0x319386,_0x40ed7c));else _0x44d757[_0x2256e9(0x3b1,0x3ca,0x396,0x36c)]=_0x3211da[_0x2256e9(0x3bf,0x3c4,0x404,0x3c4)](_0x4345b7,_0x1b2307[_0x4aab86(-0x219,-0x216,-0x23c,-0x1e4)],_0x2e1ea8[_0x4aab86(-0x219,-0x26a,-0x219,-0x224)]);}if(_0x36d889&&_0x3211da['VZHpT'](typeof _0x36d889,_0x3211da['JvnEc'])){const _0x1fc071={};for(const _0x34a98b in _0x36d889){_0x1fc071[_0x34a98b]=_0x3211da[_0x2256e9(0x432,0x410,0x47b,0x423)](replacePlaceholder,_0x36d889[_0x34a98b],_0x328d8c,_0x319386,_0x40ed7c);}return _0x1fc071;}function _0x4aab86(_0x519569,_0xc2ce25,_0x4fc1c1,_0x520efb){return _0x237b(_0x519569- -0x2cb,_0x520efb);}function _0x2256e9(_0x3aa58c,_0x49102a,_0x5fb13b,_0x17006c){return _0x237b(_0x3aa58c-0x2ff,_0x17006c);}return _0x36d889;}export function replaceAllPlaceholders(_0x5b66a0,_0x3ad4dc){const _0x3dc255={'CKQvF':function(_0x2dc9f1,_0x1290de,_0x21d42c,_0x2cdde3,_0x511f1b){return _0x2dc9f1(_0x1290de,_0x21d42c,_0x2cdde3,_0x511f1b);},'ZiQgW':function(_0x259c94){return _0x259c94();},'eibwj':_0x4b96ec(-0xc3,-0x131,-0xf0,-0x105),'vilZv':_0x46ffa0(0x2a8,0x310,0x2e9,0x305),'VDPaD':function(_0x28a743,_0x1af017,_0x32c21f,_0x22b181,_0x43ad96){return _0x28a743(_0x1af017,_0x32c21f,_0x22b181,_0x43ad96);},'LdSXk':_0x4b96ec(-0xcf,-0x123,-0x10b,-0xd8),'QkCsI':'{{世界书触发}}','OijPD':'{{正文}}','zGgFX':function(_0x32e4a1,_0x221408,_0x2d76d2,_0x17d037,_0x24b583){return _0x32e4a1(_0x221408,_0x2d76d2,_0x17d037,_0x24b583);},'SUqaf':function(_0x72f6da,_0x3ee730,_0x52e310,_0x4dc6a7,_0x514941){return _0x72f6da(_0x3ee730,_0x52e310,_0x4dc6a7,_0x514941);},'UBuNY':function(_0x199170,_0x2d0fc5,_0x130d87,_0x2dbab2,_0x356eeb){return _0x199170(_0x2d0fc5,_0x130d87,_0x2dbab2,_0x356eeb);},'CdOYU':_0x4b96ec(-0x8f,-0xeb,-0xd1,-0xe1),'uwgjk':function(_0x591427,_0x11c1a0){return _0x591427>_0x11c1a0;},'rHUQX':function(_0x39851c,_0x20d433){return _0x39851c!==_0x20d433;},'GdQxt':'FqwNQ','FeXvq':'rBRQJ','jzNed':_0x46ffa0(0x29b,0x27d,0x281,0x237),'dKBow':function(_0x41afa3,_0x50450f,_0x26ee8f,_0x393ab6,_0x2f6fd1){return _0x41afa3(_0x50450f,_0x26ee8f,_0x393ab6,_0x2f6fd1);},'sumQY':function(_0x289fc6,_0x515471,_0x49fce1){return _0x289fc6(_0x515471,_0x49fce1);}},{context:context='',body:body='',worldBookContent:worldBookContent='',variables:variables={},userDemand:userDemand='',characterListText:characterListText='',outfitEnableListText:outfitEnableListText='',commonCharacterListText:commonCharacterListText=''}=_0x3ad4dc;function _0x46ffa0(_0x5342af,_0x1b90a3,_0x7c3208,_0x3e6a00){return _0x237b(_0x7c3208-0x1be,_0x1b90a3);}const _0x7e19e=new Set();let _0x192952=_0x5b66a0;const _0xce5545=_0x3dc255[_0x4b96ec(-0xda,-0xfc,-0x11a,-0xf2)](getContext),_0x5d1b70=_0xce5545?.[_0x46ffa0(0x284,0x290,0x29c,0x261)]||'';let _0x36195f=worldBookContent;_0x36195f&&(_0x36195f=_0x36195f[_0x46ffa0(0x31f,0x2b7,0x2f6,0x347)](_0x3dc255[_0x46ffa0(0x2ec,0x288,0x2c8,0x28d)],_0x5d1b70),_0x36195f=_0x36195f[_0x4b96ec(-0x126,-0xc4,-0x88,-0xdd)](_0x3dc255[_0x4b96ec(-0x11f,-0x153,-0xfc,-0x11c)],_0x5d1b70));_0x192952=_0x3dc255[_0x46ffa0(0x2cf,0x2a0,0x2a5,0x296)](replacePlaceholder,_0x192952,_0x3dc255['LdSXk'],context,_0x7e19e),_0x192952=replacePlaceholder(_0x192952,_0x3dc255['QkCsI'],_0x36195f,_0x7e19e),_0x192952=replacePlaceholder(_0x192952,_0x3dc255['OijPD'],body,_0x7e19e),_0x192952=_0x3dc255[_0x46ffa0(0x310,0x2eb,0x2f7,0x339)](replacePlaceholder,_0x192952,_0x4b96ec(-0xa8,-0xe5,-0x11a,-0xf0),characterListText,_0x7e19e),_0x192952=replacePlaceholder(_0x192952,_0x46ffa0(0x298,0x285,0x2a0,0x262)+'}}',outfitEnableListText,_0x7e19e),_0x192952=_0x3dc255[_0x46ffa0(0x2cd,0x2eb,0x2c6,0x2ae)](replacePlaceholder,_0x192952,_0x4b96ec(-0x1b1,-0x14c,-0x161,-0x15c)+'}}',commonCharacterListText,_0x7e19e),_0x192952=_0x3dc255[_0x46ffa0(0x2c2,0x2f1,0x29d,0x249)](replacePlaceholder,_0x192952,_0x3dc255[_0x4b96ec(-0xf1,-0x117,-0x97,-0xe4)],userDemand,_0x7e19e);if(variables&&_0x3dc255[_0x46ffa0(0x2a0,0x26d,0x2ac,0x287)](Object[_0x46ffa0(0x28c,0x31f,0x2cb,0x31d)](variables)[_0x4b96ec(-0x153,-0xcc,-0x125,-0x106)],0x3*-0x82e+-0xa2d*0x2+-0xb39*-0x4)){const _0x5beaf5=/\{\{getvar::([^}]+)\}\}/g,_0x46f6d0=JSON[_0x46ffa0(0x28e,0x2be,0x2aa,0x2fa)](_0x192952),_0x42b51c=[..._0x46f6d0[_0x4b96ec(-0x6d,-0xe2,-0x6c,-0xc0)](_0x5beaf5)],_0x3f8808=new Set();for(const _0x3cc06b of _0x42b51c){if(_0x3dc255['rHUQX'](_0x3dc255[_0x46ffa0(0x278,0x2a9,0x275,0x28b)],_0x46ffa0(0x278,0x290,0x27c,0x267))){if(_0x22f653){const _0x35ec94=_0x4ad004['apply'](_0xf5ef58,arguments);return _0x552090=null,_0x35ec94;}}else _0x3f8808['add'](_0x3cc06b[0x5*0x35f+0xb08+-0x1*0x1be2]);}for(const _0x396458 of _0x3f8808){if(_0x3dc255[_0x46ffa0(0x297,0x23b,0x27b,0x28e)]!==_0x3dc255[_0x4b96ec(-0x83,-0xf9,-0x9c,-0xc1)]){const _0x23ebb0=_0x46ffa0(0x260,0x289,0x272,0x2c4)+_0x396458+'}}',_0xc052d8=variables[_0x396458]||'';_0x192952=_0x3dc255[_0x4b96ec(-0x13d,-0x143,-0x11b,-0xfd)](replacePlaceholder,_0x192952,_0x23ebb0,_0xc052d8,_0x7e19e);}else{const _0x2d4d36={};for(const _0x38ea77 in _0x37a36d){_0x2d4d36[_0x38ea77]=_0x3dc255[_0x4b96ec(-0xcd,-0xfd,-0x129,-0xe5)](_0x49fdce,_0x5cbd8f[_0x38ea77],_0x2efc43,_0xd5510,_0x1c33d0);}return _0x2d4d36;}}}function _0x4b96ec(_0x3c0de8,_0x122ca1,_0x22c3d5,_0x410c77){return _0x237b(_0x410c77- -0x215,_0x3c0de8);}_0x192952=_0x3dc255[_0x46ffa0(0x2c5,0x2a9,0x2b9,0x283)](processVariablePlaceholdersInMessages,_0x192952,_0x7e19e);const _0x2ff6d6={};return _0x2ff6d6[_0x46ffa0(0x2c6,0x286,0x2a2,0x289)]=_0x192952,_0x2ff6d6['replacedVa'+_0x46ffa0(0x2a1,0x28a,0x2a7,0x2df)]=_0x7e19e,_0x2ff6d6;}function processVariablePlaceholdersInMessages(_0x1a2669,_0x2d1840){function _0x922f81(_0x3b6db3,_0x5db7ab,_0x542286,_0xd23b8f){return _0x237b(_0x5db7ab- -0x31f,_0x3b6db3);}const _0x489c76={'vzCZT':function(_0x317b29,_0x136dd0,_0x14b82d,_0x2ad0b7){return _0x317b29(_0x136dd0,_0x14b82d,_0x2ad0b7);},'PRksM':function(_0x1bad4d,_0x22b1ec){return _0x1bad4d===_0x22b1ec;},'Eiadr':_0x922f81(-0x237,-0x235,-0x242,-0x232)};if(!_0x1a2669||_0x1a2669['length']===0x256d+-0x1f4*-0x2+-0x2955)return _0x1a2669;const _0x1e3e34=getContext();if(!_0x1e3e34[_0x3cc57b(-0x14b,-0xf9,-0x159,-0x135)+'ta']){if(_0x489c76[_0x922f81(-0x211,-0x220,-0x223,-0x1e0)](_0x489c76[_0x922f81(-0x1db,-0x1e9,-0x1f7,-0x209)],_0x922f81(-0x2a9,-0x26a,-0x218,-0x280)))return{..._0x3b13df,'text':_0x489c76['vzCZT'](_0x22785a,_0x3619f2['text'],_0x3c7e65,_0x48744d)};else _0x1e3e34['chatMetada'+'ta']={};}!_0x1e3e34[_0x3cc57b(-0xfc,-0xf8,-0xe4,-0x135)+'ta'][_0x922f81(-0x1d2,-0x20b,-0x1f4,-0x23d)]&&(_0x1e3e34['chatMetada'+'ta'][_0x3cc57b(-0xba,-0xe0,-0x107,-0x106)]={});function _0x3cc57b(_0x3d0613,_0x121c01,_0x23db34,_0x47b279){return _0x237b(_0x47b279- -0x21a,_0x23db34);}return _0x1a2669[_0x3cc57b(-0x19a,-0x148,-0x154,-0x14c)](_0x1cde22=>{function _0x46caa7(_0x3bba64,_0x27fd1d,_0x45ac86,_0x52e4dd){return _0x922f81(_0x3bba64,_0x52e4dd-0x24e,_0x45ac86-0x51,_0x52e4dd-0x138);}if(!_0x1cde22||!_0x1cde22[_0x46caa7(-0xd,-0x38,0x19,-0x1f)])return _0x1cde22;function _0x5162e6(_0x5a40f2,_0x1ca1e2,_0x249d65,_0x22cdc5){return _0x922f81(_0x1ca1e2,_0x5a40f2-0x88,_0x249d65-0x82,_0x22cdc5-0x105);}return{..._0x1cde22,'content':processContentVariables(_0x1cde22[_0x5162e6(-0x1e5,-0x1ea,-0x1a9,-0x1d2)],_0x1e3e34,_0x2d1840)};});}function processContentVariables(_0x360d41,_0x5295fb,_0x2b4583){const _0x1adbb7={};_0x1adbb7[_0x3f6a59(0xa8,0x91,0x5c,0xad)]=function(_0x1d5386,_0x3cfa90){return _0x1d5386!==_0x3cfa90;},_0x1adbb7[_0x3f6a59(0xed,0xa2,0xac,0x82)]=_0x3f6a59(0x5b,0x84,0x9c,0xdf),_0x1adbb7[_0x4c815f(0x4b1,0x4fb,0x4a0,0x4eb)]=_0x4c815f(0x4c6,0x511,0x52a,0x4e2);function _0x3f6a59(_0xef2af7,_0x26af2d,_0x2de965,_0x52aae8){return _0x237b(_0x2de965- -0x75,_0xef2af7);}_0x1adbb7[_0x3f6a59(0x41,0x2f,0x81,0x44)]=function(_0x2181ee,_0x198a6a){return _0x2181ee===_0x198a6a;},_0x1adbb7[_0x3f6a59(0x102,0xc0,0xcb,0x8d)]='string',_0x1adbb7[_0x4c815f(0x515,0x4e9,0x559,0x50f)]=_0x3f6a59(0xb,0x50,0x5b,0x61);const _0x598794=_0x1adbb7;if(_0x598794['fBRAu'](typeof _0x360d41,_0x4c815f(0x4dd,0x55a,0x53d,0x511)))return processStringVariables(_0x360d41,_0x5295fb,_0x2b4583);if(Array[_0x3f6a59(0xa2,0x4d,0x51,0x1e)](_0x360d41))return _0x360d41[_0x4c815f(0x4a6,0x4bb,0x4f1,0x4b0)](_0x29d280=>{function _0x119412(_0x52a7d5,_0x1f5f25,_0x541c19,_0x37a73c){return _0x4c815f(_0x1f5f25,_0x1f5f25-0x1b9,_0x541c19-0xfd,_0x541c19- -0x3);}function _0x4e984f(_0x4233a2,_0x3db659,_0x344375,_0x193c63){return _0x3f6a59(_0x344375,_0x3db659-0x167,_0x193c63-0x67,_0x193c63-0x10d);}if(_0x598794[_0x4e984f(0xad,0x146,0x132,0xfb)]===_0x598794[_0x4e984f(0x135,0xa6,0xaf,0xfb)]){if(_0x29d280&&_0x598794[_0x119412(0x507,0x4a3,0x4d5,0x508)](_0x29d280['type'],_0x4e984f(0xa0,0x92,0xc1,0xcb))&&_0x598794[_0x119412(0x4e1,0x4f6,0x4d5,0x487)](typeof _0x29d280[_0x4e984f(0xfb,0x7e,0x11a,0xcb)],_0x598794[_0x4e984f(0x10e,0x14f,0xeb,0x132)])){if(_0x598794[_0x119412(0x4ee,0x526,0x4d5,0x4f5)]('toOws',_0x598794[_0x4e984f(0x15c,0x147,0x12a,0x11f)]))return{..._0x29d280,'text':processStringVariables(_0x29d280[_0x4e984f(0x91,0xb4,0xbe,0xcb)],_0x5295fb,_0x2b4583)};else for(const _0x45b68c of _0x49039a[_0x119412(0x48e,0x464,0x4a1,0x4ec)]){if(_0x45b68c['user']&&_0x598794[_0x4e984f(0xdd,0xd9,0xa8,0xc3)](_0x45b68c['user']['trim'](),'')){const _0x2a4134={};_0x2a4134[_0x4e984f(0xd3,0xdc,0x11e,0x10c)]=_0x598794['IYQhs'],_0x2a4134[_0x119412(0x4ab,0x47d,0x491,0x44b)]=_0x45b68c['user'],_0xc42961['push'](_0x2a4134);}if(_0x45b68c[_0x4e984f(0x120,0x144,0x174,0x130)]&&_0x598794['RNtIa'](_0x45b68c['assistant'][_0x119412(0x505,0x4fa,0x4bb,0x508)](),'')){const _0x544ba4={};_0x544ba4[_0x119412(0x507,0x4d8,0x4f9,0x4fa)]=_0x4e984f(0x170,0x16c,0x168,0x130),_0x544ba4[_0x119412(0x498,0x453,0x491,0x4c1)]=_0x45b68c['assistant'],_0x1f3bc2[_0x119412(0x4e8,0x4c4,0x4bc,0x4a3)](_0x544ba4);}}}return _0x29d280;}else return[];});function _0x4c815f(_0x3faf75,_0x1ecc46,_0x4cdd58,_0x492366){return _0x237b(_0x492366-0x3e2,_0x3faf75);}return _0x360d41;}function processStringVariables(_0x40a698,_0x17dbbb,_0x1900c9){const _0x4c1cc1={'luoGd':function(_0x4ac9b6,_0x1aae7b){return _0x4ac9b6===_0x1aae7b;},'gBhIJ':_0x4e4cd8(-0x23a,-0x232,-0x1c1,-0x203),'WnnUw':_0x4e4cd8(-0x1c4,-0x1dd,-0x191,-0x1c2),'vfkpc':function(_0x2c25c2,_0xbb383,_0x18a07f){return _0x2c25c2(_0xbb383,_0x18a07f);},'keItH':function(_0x4799fe,_0x3216c1){return _0x4799fe(_0x3216c1);},'RfJAP':function(_0x58878c,_0x2161e4,_0x26d36b,_0x13369d){return _0x58878c(_0x2161e4,_0x26d36b,_0x13369d);},'gndhe':_0x4e4cd8(-0x19b,-0x1af,-0x179,-0x185),'Vbkvr':function(_0x613c2c,_0xdb842e){return _0x613c2c(_0xdb842e);},'joKrw':function(_0x169215,_0x434d8d){return _0x169215!==_0x434d8d;},'lIpbj':_0x4e4cd8(-0x1af,-0x1c2,-0x1b3,-0x1a8),'fIRfG':_0x473e8d(0x35e,0x3be,0x3a7,0x36e),'qVjqy':function(_0x41abf4,_0x2d3d80,_0xf626e9,_0x1b92f6,_0x515536){return _0x41abf4(_0x2d3d80,_0xf626e9,_0x1b92f6,_0x515536);},'jnUvj':_0x4e4cd8(-0x230,-0x228,-0x1af,-0x1ff),'moWYt':'nhlHy'};function _0x473e8d(_0x54c988,_0x38459d,_0x58cc35,_0x5a6fa5){return _0x237b(_0x58cc35-0x2ed,_0x38459d);}if(!_0x40a698)return _0x40a698;function _0x4e4cd8(_0xf31f5e,_0x2b1769,_0x2afb7c,_0x5dc82d){return _0x237b(_0x5dc82d- -0x2ce,_0x2afb7c);}let _0x3575e7=_0x40a698;return _0x3575e7=_0x3575e7[_0x4e4cd8(-0x199,-0x196,-0x157,-0x181)](/\{@setvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x10a71f,_0x3de779,_0x263296)=>{const _0x2ddcf4=_0x3de779[_0xe3bbd3(0x4e,0x32,0x96,0x87)]();_0x17dbbb['chatMetada'+'ta'][_0x3df30d(0x36f,0x3ad,0x365,0x337)][_0x2ddcf4]=_0x263296;function _0xe3bbd3(_0x1075ee,_0x5c8229,_0x5d92b4,_0x4e0ac1){return _0x4e4cd8(_0x1075ee-0xbb,_0x5c8229-0x146,_0x4e0ac1,_0x1075ee-0x240);}if(_0x1900c9){if(_0x4c1cc1[_0x3df30d(0x31e,0x341,0x341,0x351)]('rbIka',_0x4c1cc1[_0x3df30d(0x356,0x37c,0x349,0x38e)]))_0x1900c9[_0xe3bbd3(0x48,0x8b,0x9c,0x4)]('{@setvar::'+_0x2ddcf4+'@}');else return![];}function _0x3df30d(_0x465298,_0x59abc4,_0x441149,_0x1abdae){return _0x473e8d(_0x465298-0x11f,_0x465298,_0x441149- -0x9c,_0x1abdae-0x7b);}return'';}),_0x3575e7=_0x3575e7['replace'](/\{@getvar::([^@]+)@\}/g,(_0x38601d,_0x1282ca)=>{function _0x4b0738(_0x22bc33,_0x22ddce,_0xd147a0,_0x1986e0){return _0x473e8d(_0x22bc33-0x10a,_0x1986e0,_0x22ddce- -0x4f,_0x1986e0-0x174);}const _0x296ccf=_0x1282ca['trim'](),_0x3e5ec8=_0x17dbbb[_0x2df4f7(0x437,0x3de,0x481,0x433)+'ta'][_0x4b0738(0x3d2,0x3b2,0x3f5,0x3ae)][_0x296ccf]||'';if(_0x1900c9){if(_0x4c1cc1[_0x2df4f7(0x490,0x400,0x462,0x43e)](_0x4c1cc1[_0x2df4f7(0x4e5,0x46e,0x46f,0x49f)],_0x2df4f7(0x45e,0x48f,0x4a0,0x46b))){const _0x17170b=_0x5026d5[_0x2df4f7(0x470,0x46a,0x412,0x42a)](),_0x192459=_0x2cfbbd[_0x2df4f7(0x47a,0x468,0x440,0x433)+'ta']['variables'][_0x17170b]||'';return _0x21c71b&&_0x29a090[_0x2df4f7(0x43a,0x408,0x43a,0x424)](_0x2df4f7(0x447,0x4ae,0x431,0x467)+_0x17170b+'@}'),_0x192459;}else _0x1900c9['add'](_0x4b0738(0x397,0x3b7,0x40a,0x373)+_0x296ccf+'@}');}function _0x2df4f7(_0xa1af1d,_0x2e7628,_0x4b4cf6,_0x1ae327){return _0x4e4cd8(_0xa1af1d-0x86,_0x2e7628-0x20,_0x4b4cf6,_0x1ae327-0x61c);}return _0x3e5ec8;}),_0x3575e7=_0x3575e7[_0x473e8d(0x439,0x448,0x43a,0x40a)](/\{@setglobalvar::([^:@]+)::([\s\S]*?)@\}/g,(_0x4ced42,_0x4f9afa,_0x36ea6b)=>{const _0x17e0ac=_0x4f9afa[_0x434688(-0x193,-0x1a3,-0x18a,-0x147)]();function _0x3844a8(_0x506f97,_0x4ab5b1,_0x43eed1,_0xd0b605){return _0x473e8d(_0x506f97-0x1c5,_0x43eed1,_0xd0b605- -0x1f6,_0xd0b605-0x1e2);}_0x4c1cc1[_0x434688(-0x1d8,-0x188,-0x1a7,-0x199)](setglobalvar,_0x17e0ac,_0x36ea6b);_0x1900c9&&_0x1900c9[_0x434688(-0x168,-0x1e5,-0x190,-0x16e)](_0x434688(-0xeb,-0x146,-0x131,-0x13c)+'lvar::'+_0x17e0ac+'@}');function _0x434688(_0x442663,_0x2d0fa9,_0x4b3dc2,_0x166b1e){return _0x473e8d(_0x442663-0x1da,_0x2d0fa9,_0x4b3dc2- -0x553,_0x166b1e-0x109);}return'';}),_0x3575e7=_0x3575e7[_0x473e8d(0x462,0x41c,0x43a,0x3f0)](/\{@getglobalvar::([^@]+)@\}/g,(_0x44be86,_0x5991b9)=>{function _0x4ee48d(_0x4d5a94,_0x41da16,_0x4a1a8c,_0x50fbb0){return _0x473e8d(_0x4d5a94-0x193,_0x50fbb0,_0x41da16- -0x119,_0x50fbb0-0x4d);}const _0x5722bb={'HFXSR':function(_0x15f581,_0x15390b,_0x4117b5,_0xed9d34){function _0x5934f6(_0x265c27,_0x4c66bd,_0x42ef26,_0x47b2a3){return _0x237b(_0x4c66bd-0x24a,_0x42ef26);}return _0x4c1cc1[_0x5934f6(0x347,0x36a,0x392,0x32f)](_0x15f581,_0x15390b,_0x4117b5,_0xed9d34);}};function _0x25a29c(_0x34b9f3,_0x1fda76,_0xc14680,_0x3af94a){return _0x4e4cd8(_0x34b9f3-0x18b,_0x1fda76-0xd7,_0x34b9f3,_0x1fda76- -0x7a);}if(_0x4c1cc1[_0x4ee48d(0x314,0x32a,0x326,0x2ec)]!==_0x4ee48d(0x32b,0x30b,0x33d,0x2e2)){const _0x565679=_0x5991b9[_0x25a29c(-0x28f,-0x26c,-0x27b,-0x2b2)](),_0x299915=_0x4c1cc1['Vbkvr'](getglobalvar,_0x565679)||'';if(_0x1900c9){if(_0x4c1cc1['joKrw'](_0x4c1cc1[_0x4ee48d(0x352,0x32b,0x368,0x346)],_0x4c1cc1[_0x25a29c(-0x1e5,-0x1f8,-0x22d,-0x1bb)]))_0x1900c9['add'](_0x4ee48d(0x28a,0x2a6,0x2ac,0x252)+_0x4ee48d(0x299,0x2ac,0x2ee,0x276)+_0x565679+'@}');else{const _0x46692a=_0x609e9b[_0x4ee48d(0x2be,0x2b0,0x2f7,0x25d)](),_0x2fe3a0=_0x4c1cc1[_0x4ee48d(0x2d4,0x31a,0x342,0x315)](_0x4bdd5c,_0x46692a)||'';return _0x3441fa&&_0x533080[_0x25a29c(-0x29f,-0x272,-0x25c,-0x253)](_0x25a29c(-0x27f,-0x287,-0x27a,-0x2a9)+_0x25a29c(-0x24b,-0x28d,-0x2c5,-0x2af)+_0x46692a+'@}'),_0x2fe3a0;}}return _0x299915;}else return _0x5722bb['HFXSR'](_0x2cbef9,_0x7daee1,_0x5dcdcd,_0x3f5106);}),_0x3575e7=_0x3575e7[_0x473e8d(0x3f8,0x441,0x43a,0x466)](/\{@getworldvar::([^@]+)@\}/g,(_0x3902d,_0x28ffd5)=>{const _0x551762={'tPDbF':function(_0x66b1fc,_0x5a51a1,_0xd498f6,_0x3e79c5,_0x5b080f){function _0x279813(_0x3bcaf1,_0x12afb0,_0x29c92c,_0x18369c){return _0x237b(_0x18369c- -0x202,_0x12afb0);}return _0x4c1cc1[_0x279813(-0x9b,-0xfc,-0xca,-0xd9)](_0x66b1fc,_0x5a51a1,_0xd498f6,_0x3e79c5,_0x5b080f);}},_0x2de5fe=_0x28ffd5[_0x11b0a1(-0x287,-0x2d1,-0x285,-0x2d0)](),_0x245fea=getworldvar(_0x2de5fe)||'';if(_0x1900c9){if(_0x4c1cc1['jnUvj']!==_0x4c1cc1['moWYt'])_0x1900c9[_0xb06f7c(0x3a1,0x353,0x380,0x3ea)]('{@getworld'+'var::'+_0x2de5fe+'@}');else{const _0x2e3a63=/\{\{getvar::([^}]+)\}\}/g,_0x4c0ca4=_0x2f0994[_0x11b0a1(-0x2ec,-0x2ae,-0x2ea,-0x2c0)](_0x33efe5),_0x539814=[..._0x4c0ca4['matchAll'](_0x2e3a63)],_0x290f2f=new _0x3148c5();for(const _0x1b9bb6 of _0x539814){_0x290f2f[_0xb06f7c(0x3a1,0x3f2,0x39d,0x3c2)](_0x1b9bb6[-0x141b*-0x1+-0x1d86*-0x1+-0x10*0x31a]);}for(const _0xdc8777 of _0x290f2f){const _0x90e5e8=_0x11b0a1(-0x344,-0x306,-0x329,-0x2f8)+_0xdc8777+'}}',_0x3f16af=_0x33751b[_0xdc8777]||'';_0x317af5=_0x551762[_0x11b0a1(-0x2dc,-0x24e,-0x2c5,-0x28d)](_0x43fdcd,_0x596f55,_0x90e5e8,_0x3f16af,_0x77e327);}}}function _0xb06f7c(_0x1f6a13,_0x5e7a36,_0xdac925,_0x17bfa1){return _0x4e4cd8(_0x1f6a13-0x74,_0x5e7a36-0x74,_0x5e7a36,_0x1f6a13-0x599);}function _0x11b0a1(_0x5cf93b,_0x177d24,_0x2d67d4,_0x17d399){return _0x4e4cd8(_0x5cf93b-0xcb,_0x177d24-0x1c5,_0x5cf93b,_0x17d399- -0xde);}return _0x245fea;}),_0x3575e7;}export function buildPromptWithTrigger(_0x386317){const _0x59aeb={'FZkIL':function(_0x491989,_0x56a26f,_0x51a1aa){return _0x491989(_0x56a26f,_0x51a1aa);},'itWoI':function(_0x23eba5,_0x59a1fd){return _0x23eba5!==_0x59a1fd;},'rqoux':_0x157555(0x512,0x506,0x4d0,0x50b),'KeCvl':_0x157555(0x4b0,0x4fd,0x4c2,0x4bf),'TMXuc':function(_0x45bcbd,_0x28b088){return _0x45bcbd===_0x28b088;},'qYvDh':function(_0x23711a,_0x3e0b83){return _0x23711a===_0x3e0b83;},'DgCie':'trigger','gsRBH':'user','bnbYH':_0x157555(0x4c0,0x503,0x4e6,0x52a),'LCHuM':_0x2aebcd(0x13f,0x18b,0x1b2,0x178),'qitok':function(_0x3ab885,_0x2434f2){return _0x3ab885(_0x2434f2);}},{requestType:_0x33ba90,contextData:_0x240ea2}=_0x386317,_0x1bcb58=extension_settings[extensionName]?.[_0x157555(0x44e,0x488,0x4da,0x442)+_0x2aebcd(0x169,0x160,0x181,0x172)+_0x157555(0x48f,0x481,0x44e,0x459)]||{},_0x56fab7={};_0x56fab7[_0x157555(0x45d,0x49f,0x4e5,0x46d)+'ofile']='默认';const _0x527917=_0x1bcb58[_0x33ba90]||_0x56fab7,_0xaf9eba=_0x527917['context_pr'+_0x2aebcd(0x15f,0x14b,0x123,0x17e)]||'默认',_0x480288=extension_settings[extensionName]?.[_0x157555(0x456,0x49c,0x48e,0x464)+_0x157555(0x4dc,0x500,0x4b8,0x50a)+'s']||{},_0x3e574c=_0x480288[_0xaf9eba]||_0x480288[Object[_0x157555(0x485,0x4c9,0x4ec,0x4dd)](_0x480288)[-0x39*-0x31+-0x1*-0xf91+-0xd3d*0x2]]||{},{context:context='',body:body='',worldBookContent:worldBookContent='',userDemand:userDemand=''}=_0x240ea2,_0x3ed4fc=[userDemand,context,body,worldBookContent][_0x2aebcd(0x146,0x109,0x13c,0xb6)](Boolean)[_0x157555(0x4f3,0x4f6,0x4ea,0x4a3)]('\x0a'),_0x4aa339=[];function _0x157555(_0x3dd98c,_0x4354b3,_0x420066,_0x1532d5){return _0x237b(_0x4354b3-0x3bc,_0x1532d5);}if(_0x3e574c[_0x2aebcd(0x142,0x115,0x117,0x103)]&&Array[_0x2aebcd(0x117,0x113,0xc0,0x13b)](_0x3e574c[_0x2aebcd(0x10e,0x115,0x14c,0xc8)])){if(_0x59aeb['itWoI'](_0x59aeb[_0x157555(0x501,0x4e8,0x4d1,0x4d1)],_0x59aeb[_0x2aebcd(0x154,0x121,0x113,0xd9)]))for(const _0x1986a7 of _0x3e574c[_0x157555(0x42f,0x484,0x480,0x48f)]){if(!_0x1986a7[_0x2aebcd(0x14d,0x15f,0x1a0,0x160)])continue;if(!_0x1986a7[_0x2aebcd(0xad,0xff,0x115,0xc4)]||_0x59aeb[_0x157555(0x4b4,0x4f8,0x508,0x4c2)](_0x1986a7[_0x157555(0x497,0x46e,0x4af,0x46d)]['trim'](),''))continue;if(_0x59aeb[_0x2aebcd(0x130,0x16b,0x169,0x13a)](_0x1986a7[_0x157555(0x4ec,0x4ca,0x511,0x4a9)+'e'],_0x59aeb[_0x157555(0x4bc,0x4b0,0x490,0x46c)])){if(!checkTriggerWords(_0x1986a7[_0x2aebcd(0x191,0x150,0x1a2,0xfd)+'ds'],_0x3ed4fc))continue;}const _0x189595={};_0x189595[_0x2aebcd(0x14b,0x167,0x14c,0x182)]=_0x1986a7[_0x157555(0x4e6,0x4d6,0x520,0x516)]||_0x59aeb['gsRBH'],_0x189595[_0x2aebcd(0xca,0xff,0xd0,0xf4)]=_0x1986a7[_0x157555(0x443,0x46e,0x41e,0x474)],_0x4aa339['push'](_0x189595);}else{const _0x13804b=_0x5e034f[_0x157555(0x477,0x498,0x4ba,0x484)]();return _0x59aeb[_0x157555(0x530,0x501,0x548,0x4c3)](_0x5022e6,_0x13804b,_0x7a7561),_0x23a090&&_0x10f29f[_0x157555(0x450,0x492,0x46d,0x481)](_0x2aebcd(0x144,0x182,0x17a,0x19a)+_0x2aebcd(0x105,0x125,0xfb,0x121)+_0x13804b+'@}'),'';}}else{if(_0x3e574c[_0x157555(0x46c,0x47e,0x44f,0x4ab)]&&Array[_0x2aebcd(0x139,0x113,0xce,0x121)](_0x3e574c[_0x2aebcd(0x100,0x10f,0x12f,0x133)]))for(const _0x1fe056 of _0x3e574c['history']){if(_0x1fe056['user']&&_0x59aeb[_0x2aebcd(0x17d,0x163,0x1b4,0x12a)](_0x1fe056[_0x2aebcd(0x185,0x15e,0x10a,0x1a0)]['trim'](),'')){const _0x48484c={};_0x48484c[_0x157555(0x510,0x4d6,0x4b5,0x49d)]=_0x59aeb[_0x2aebcd(0x12f,0x114,0xc2,0x109)],_0x48484c['content']=_0x1fe056[_0x2aebcd(0x127,0x15e,0x183,0x16b)],_0x4aa339['push'](_0x48484c);}if(_0x1fe056['assistant']&&_0x1fe056[_0x2aebcd(0x1dd,0x18b,0x17d,0x16b)][_0x2aebcd(0xf8,0x129,0x10b,0x163)]()!==''){if(_0x59aeb[_0x157555(0x4a3,0x4da,0x497,0x4d7)](_0x59aeb[_0x157555(0x4f5,0x4d8,0x4c5,0x49c)],_0x59aeb[_0x157555(0x517,0x4d8,0x4e5,0x4b7)])){const _0x27d94a={};_0x27d94a[_0x2aebcd(0x11a,0x167,0x186,0x15c)]=_0x59aeb[_0x157555(0x4c5,0x4b9,0x498,0x4a8)],_0x27d94a['content']=_0x1fe056[_0x157555(0x4c9,0x4fa,0x4d0,0x529)],_0x4aa339[_0x157555(0x490,0x499,0x44b,0x44e)](_0x27d94a);}else _0x17e542[_0x2aebcd(0xdd,0x123,0x120,0x10f)](_0x2aebcd(0xf8,0x11f,0xda,0x13a)+_0x157555(0x48c,0x494,0x4bf,0x4cb)+_0x5c057b+'@}');}}}const _0x3e6692=_0x59aeb['qitok'](mergeAdjacentMessages,_0x4aa339);function _0x2aebcd(_0x27c88e,_0x2e9d01,_0x29589b,_0x5f283c){return _0x237b(_0x2e9d01-0x4d,_0x27c88e);}const {messages:_0x17c10a,replacedVariables:_0xf50372}=_0x59aeb[_0x157555(0x524,0x501,0x516,0x4f2)](replaceAllPlaceholders,_0x3e6692,_0x240ea2);return _0x17c10a;}function _0x237b(_0x17ca65,_0x2a3bfb){_0x17ca65=_0x17ca65-(-0x54a+-0x5ec*0x1+-0xb*-0x115);const _0x4182c3=_0x5bbe();let _0xf2357d=_0x4182c3[_0x17ca65];if(_0x237b['LeWubS']===undefined){var _0x4ceeda=function(_0x3364c3){const _0xef0d7c='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x5ed2c6='',_0x39f17f='',_0x501c75=_0x5ed2c6+_0x4ceeda;for(let _0x2c96ba=0x954+0xb3d*0x1+-0x2d*0x75,_0x308ee9,_0x46a612,_0x53bc4a=0x9*-0x2db+-0x185f+0x3212;_0x46a612=_0x3364c3['charAt'](_0x53bc4a++);~_0x46a612&&(_0x308ee9=_0x2c96ba%(0xc93*0x3+-0x9c*0xd+-0x19*0x131)?_0x308ee9*(-0x1e31+0x1*0x20e6+0x25*-0x11)+_0x46a612:_0x46a612,_0x2c96ba++%(-0x3*-0x86d+-0x1*-0x1e31+-0x3774))?_0x5ed2c6+=_0x501c75['charCodeAt'](_0x53bc4a+(-0x1639*-0x1+0x1a7a*-0x1+0x44b))-(-0x88+-0x1ace*0x1+-0x6d8*-0x4)!==0x6c*-0x4+0x75b*-0x4+0xb5*0x2c?String['fromCharCode'](0x1fd+0x1*-0x62+-0x9c&_0x308ee9>>(-(-0x236b+-0x53*0x13+0x2996)*_0x2c96ba&-0x197f+0xb0*-0x15+-0xc1*-0x35)):_0x2c96ba:0x994+-0x1aa3+0x110f*0x1){_0x46a612=_0xef0d7c['indexOf'](_0x46a612);}for(let _0x14e785=-0xbf+-0x1bc0+0x5*0x5b3,_0x3d5fd0=_0x5ed2c6['length'];_0x14e785<_0x3d5fd0;_0x14e785++){_0x39f17f+='%'+('00'+_0x5ed2c6['charCodeAt'](_0x14e785)['toString'](0x15b1*0x1+0x85*0x3a+-0x33c3))['slice'](-(-0x2364+0x4*-0x17b+0x2952));}return decodeURIComponent(_0x39f17f);};_0x237b['gfbCYW']=_0x4ceeda,_0x237b['ocwnEE']={},_0x237b['LeWubS']=!![];}const _0x4fcc65=_0x4182c3[-0x149+-0x1*-0xe59+-0x344*0x4],_0x3c2c47=_0x17ca65+_0x4fcc65,_0x2965f2=_0x237b['ocwnEE'][_0x3c2c47];if(!_0x2965f2){const _0x538658=function(_0x3c0294){this['MHssou']=_0x3c0294,this['eFPAWK']=[0x4d4+0xcc9*0x1+-0x119c,-0x8b3+-0xc*0x11+0x8f*0x11,-0x719+0x1*-0x9d+0x7b6],this['jAObKw']=function(){return'newState';},this['fBWfhm']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['OphNJH']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x538658['prototype']['csvwua']=function(){const _0x20814c=new RegExp(this['fBWfhm']+this['OphNJH']),_0x352951=_0x20814c['test'](this['jAObKw']['toString']())?--this['eFPAWK'][-0x51b+0x1540+-0x1024]:--this['eFPAWK'][0x1a*-0xf1+-0x30e+-0x4*-0x6e2];return this['RCFcXh'](_0x352951);},_0x538658['prototype']['RCFcXh']=function(_0x169d5b){if(!Boolean(~_0x169d5b))return _0x169d5b;return this['jgCPRI'](this['MHssou']);},_0x538658['prototype']['jgCPRI']=function(_0xe6b35b){for(let _0x45d32e=-0x2a3+-0x211*-0xc+-0x1629,_0x458520=this['eFPAWK']['length'];_0x45d32e<_0x458520;_0x45d32e++){this['eFPAWK']['push'](Math['round'](Math['random']())),_0x458520=this['eFPAWK']['length'];}return _0xe6b35b(this['eFPAWK'][0x1a96+-0x2*-0x1227+-0xa1*0x64]);},new _0x538658(_0x237b)['csvwua'](),_0xf2357d=_0x237b['gfbCYW'](_0xf2357d),_0x237b['ocwnEE'][_0x3c2c47]=_0xf2357d;}else _0xf2357d=_0x2965f2;return _0xf2357d;}export function getProcessedPrompt(_0x3a6f0f,_0x3d8fb6){const _0x21bb1d={};_0x21bb1d[_0x5b2bdf(0x297,0x27d,0x2ed,0x2b3)+'e']=_0x3a6f0f;function _0x5b2bdf(_0x5be90a,_0x47bfe0,_0x355ce0,_0x31a6dc){return _0x237b(_0x31a6dc-0x1cb,_0x5be90a);}_0x21bb1d[_0x1e7035(-0x1ee,-0x206,-0x1ef,-0x1f2)+'a']=_0x3d8fb6;function _0x1e7035(_0x5c82ec,_0x5d75eb,_0x500c93,_0x8fade9){return _0x237b(_0x500c93- -0x2dc,_0x8fade9);}return buildPromptWithTrigger(_0x21bb1d);}